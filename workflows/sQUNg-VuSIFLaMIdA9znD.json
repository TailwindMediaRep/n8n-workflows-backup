{
  "active": true,
  "activeVersion": {
    "updatedAt": "2026-01-28T08:43:19.000Z",
    "createdAt": "2026-01-28T08:43:17.786Z",
    "versionId": "67bdb6dc-6e06-4de8-8630-155b38bd686c",
    "workflowId": "sQUNg-VuSIFLaMIdA9znD",
    "nodes": [
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "informeDiario",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          240,
          480
        ],
        "id": "3a169d65-fc08-45f0-a1c1-197ef4d4aa08",
        "name": "Webhook",
        "webhookId": "7c1e3b37-6cc8-4f4a-81e3-c5897bdf497c"
      },
      {
        "parameters": {
          "authentication": "headerAuth",
          "endpoint": "https://rulesshop.myshopify.com/admin/api/2024-07/graphql.json",
          "query": "query getOrder($id: ID!) {\n\n  order(id: $id) {\n\n    id\n\n    name\n\n    createdAt\n\n    email\n\n    totalPriceSet {\n\n      shopMoney {\n\n        amount\n\n        currencyCode\n\n      }\n\n    }\n\n    lineItems(first: 10) {\n\n      edges {\n\n        node {\n\n          title\n\n          quantity\n\n          originalUnitPriceSet {\n\n            shopMoney {\n\n              amount\n\n              currencyCode\n\n            }\n\n          }\n\n        }\n\n      }\n\n    }\n\n    fulfillments {\n\n      id\n\n      location {\n\n        name\n\n        address {\n\n          address1\n\n          city\n\n          province\n\n          country\n\n          zip\n\n        }\n\n      }\n\n    }\n\n    transactions(first: 5) {\n\n      formattedGateway\n\n      kind\n\n      status\n\n    }\n\n    customer {\n\n      firstName\n\n      lastName\n\n      email\n\n    }\n\n  }\n\n}\n",
          "variables": "={\n  \"id\": \"gid://shopify/Order/{{ $('Webhook').item.json.body.id }}\"\n}",
          "headerParametersUi": {
            "parameter": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "type": "n8n-nodes-base.graphql",
        "typeVersion": 1.1,
        "position": [
          624,
          480
        ],
        "id": "7255d822-ea0d-446d-83c9-1aee124ad0e8",
        "name": "GraphQL",
        "credentials": {
          "httpHeaderAuth": {
            "id": "OPt2Cl0dnwcU4qRk",
            "name": "ShopifyInformes"
          }
        }
      },
      {
        "parameters": {
          "content": "ENVIAR CORREO",
          "height": 208,
          "width": 384,
          "color": 4
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          192,
          768
        ],
        "id": "070b8235-6802-470b-bd7a-884c6711458e",
        "name": "Sticky Note1"
      },
      {
        "parameters": {
          "operation": "copy",
          "fileId": {
            "__rl": true,
            "value": "1QZ-GBz6D6EL4fZh3lh9PyAjwWzyjVn8nN0wy4mUjg04",
            "mode": "id"
          },
          "name": "=Informe_Diario_{{ $json.FECHA }}",
          "options": {}
        },
        "type": "n8n-nodes-base.googleDrive",
        "typeVersion": 3,
        "position": [
          656,
          128
        ],
        "id": "67d0cf56-a4b3-432d-9ab3-2b819b9f63a8",
        "name": "Copy file",
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "N7JXWgOiVoyCTaVL",
            "name": "Google Drive account"
          }
        }
      },
      {
        "parameters": {
          "content": "CREAR DOCUMENTO",
          "height": 208,
          "width": 960,
          "color": 6
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          192,
          80
        ],
        "id": "2b6bbfe7-3af9-4eb7-a19d-ec2a3322de91",
        "name": "Sticky Note2"
      },
      {
        "parameters": {
          "rule": {
            "interval": [
              {}
            ]
          }
        },
        "type": "n8n-nodes-base.scheduleTrigger",
        "typeVersion": 1.3,
        "position": [
          224,
          128
        ],
        "id": "62e5fa32-0ae7-493b-875f-e37addba632a",
        "name": "Schedule Trigger"
      },
      {
        "parameters": {
          "dataTableId": {
            "__rl": true,
            "value": "8GDVj673ag0hCrVt",
            "mode": "list",
            "cachedResultName": "Informe Mensual",
            "cachedResultUrl": "/projects/x5UZcmGQw2OWHuXb/datatables/8GDVj673ag0hCrVt"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "ID_Documento": "={{ $('Copy file').item.json.id }}",
              "fecha": "={{ $('formatear fecha').item.json.FECHA }}"
            },
            "matchingColumns": [
              "ID_Documento"
            ],
            "schema": [
              {
                "id": "ID_Documento",
                "displayName": "ID_Documento",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "fecha",
                "displayName": "fecha",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.dataTable",
        "typeVersion": 1,
        "position": [
          960,
          128
        ],
        "id": "e5db14bd-7dca-40a9-bee1-b422e5e5f4a0",
        "name": "Insert row"
      },
      {
        "parameters": {
          "jsCode": "// El nodo Code de n8n espera que devolvamos un array de objetos.\nconst outputItems = [];\n\n// Obtenemos el valor del contador del nodo anterior\n// items[0].json.Contador → 2 en tu ejemplo\nlet numeroFila = items[0].json.Contador;\nlet ID_documento = items[0].json.ID_Documento;\n\n// 1. Accedemos al cuerpo real del pedido de Shopify, que está anidado.\nconst orderBody = $node['Webhook'].json.body; \n\n// 2. Extraemos los artículos de línea (productos) y la moneda.\nconst lineItems = orderBody.line_items;\nconst orderCurrency = orderBody.currency;\n\n// Iteramos sobre cada producto individual\nfor (const item of lineItems) {\n\n  const originalPrice = parseFloat(item.price);\n\n  let totalDiscountAmount = 0;\n  for (const allocation of item.discount_allocations) {\n    totalDiscountAmount += parseFloat(allocation.amount);\n  }\n\n  const finalPaidPrice = originalPrice - totalDiscountAmount;\n\n  // Creamos un nuevo objeto y añadimos \"numero_fila\"\n  outputItems.push({\n    json: {\n      ID_documento: ID_documento,\n      numero_fila: numeroFila,   // ← Nuevo campo\n      product_name: item.title,\n      sku: item.sku,\n      variant_title: item.variant_title,\n      original_price: originalPrice.toFixed(2),\n      total_discount_applied: totalDiscountAmount.toFixed(2),\n      final_paid_price: finalPaidPrice.toFixed(2),\n      currency: orderCurrency\n    }\n  });\n\n  // ↑ Incrementamos para el siguiente item\n  numeroFila++;\n}\n\n// Devolvemos el array con los nuevos objetos.\nreturn outputItems;\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          624,
          624
        ],
        "id": "f74317cd-37d0-4262-a761-d94cdf479b6a",
        "name": "Code in JavaScript"
      },
      {
        "parameters": {
          "numberInputs": 3
        },
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.2,
        "position": [
          864,
          464
        ],
        "id": "5007c6bb-31eb-4b15-be8a-fb06c3e7962e",
        "name": "Merge"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "31828549-6a33-4e8a-91ad-fdb9692a7e34",
                "name": "SUCURSAL DE VENTA",
                "value": "={{ $json.fulfillmentLocation }}",
                "type": "string"
              },
              {
                "id": "e89736ae-2f29-40c8-80b4-2181722ee3f5",
                "name": "METODO DE PAGO",
                "value": "={{ $json.transactionGateway }}",
                "type": "string"
              },
              {
                "id": "dc4a77f5-966d-4efc-b755-1f0fe34f6958",
                "name": "COSTO POR UNIDAD",
                "value": "={{ $json.product.unit_cost }}",
                "type": "string"
              },
              {
                "id": "76140f31-efab-4a68-b737-53f04a9a7b81",
                "name": "COSTE DE PRODUCTO",
                "value": "={{ $json.product.original_price }}",
                "type": "string"
              },
              {
                "id": "d295df2e-e935-41ef-a2b1-7923cabd1a92",
                "name": "PRECIO PAGADO",
                "value": "={{ $json.product.final_paid_price }}",
                "type": "string"
              },
              {
                "id": "adb9ae5a-50d9-4923-b706-31a9a5b86e66",
                "name": "DESCUENTO",
                "value": "={{ $json.product.total_discount_applied }}",
                "type": "string"
              },
              {
                "id": "c2b11c61-81c1-4b6d-94ec-c55b6872e5e0",
                "name": "NOMBRE DE PRODUCTO",
                "value": "={{ $json.product.product_name }}",
                "type": "string"
              },
              {
                "id": "f7cbe128-fbe4-4bfb-b5ec-d7eed2f87b84",
                "name": "VARIANTE",
                "value": "={{ $json.product.variant_title }}",
                "type": "string"
              },
              {
                "id": "1e31a3b3-a073-4113-9047-95110c3d7987",
                "name": "NUMERO_FILA",
                "value": "={{ $json.product.numero_fila }}",
                "type": "number"
              },
              {
                "id": "e4c20adf-aa16-46e1-9851-3844e08241a6",
                "name": "ID_DOCUMENTO",
                "value": "={{ $json.product.ID_documento }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          1136,
          480
        ],
        "id": "b52e6336-e7f7-40dd-ad46-c520b057c406",
        "name": "Edit Fields"
      },
      {
        "parameters": {
          "jsCode": "// 1. Validaciones básicas\nif (items.length < 2) {\n    throw new Error(\"Se esperaban al menos 2 ítems de entrada.\");\n}\n\n// Inicializamos variables\nlet orderData = null;\nconst productRows = []; // Aquí guardaremos los ítems que tienen ID_documento\nconst costMap = {}; // Aquí guardaremos los costos indexados por SKU\n\n// 2. Clasificar los ítems de entrada\nfor (const item of items) {\n    const json = item.json;\n\n    // A) Es la ORDEN (tiene data.order)\n    if (json.data && json.data.order) {\n        orderData = json.data.order;\n    } \n    // B) Es información de COSTO de Shopify (tiene data.productVariant)\n    else if (json.data && json.data.productVariant) {\n        const variant = json.data.productVariant;\n        const sku = variant.sku;\n        const costAmount = variant.inventoryItem?.unitCost?.amount;\n        \n        // Guardamos el costo en un objeto usando el SKU como clave para buscarlo rápido después\n        if (sku && costAmount) {\n            costMap[sku] = costAmount;\n        }\n    }\n    // C) Es el ítem procesado (tiene ID_documento)\n    else if (json.ID_documento) {\n        productRows.push(json);\n    }\n}\n\nif (!orderData) {\n    throw new Error(\"No se encontró el ítem de la orden de Shopify.\");\n}\n\nif (productRows.length === 0) {\n    throw new Error(\"No se encontraron ítems de producto con ID_documento.\");\n}\n\n// 3. Crear objeto base de la orden\nconst baseOrderData = {\n    id: orderData.id,\n    name: orderData.name,\n    createdAt: orderData.createdAt,\n    totalPrice: orderData.totalPriceSet?.shopMoney?.amount || 'N/A',\n    currencyCode: orderData.totalPriceSet?.shopMoney?.currencyCode || 'N/A',\n    \n    // Datos del cliente\n    customer: orderData.customer,\n    \n    // Datos de envío\n    fulfillmentLocation: orderData.fulfillments?.[0]?.location?.name || 'N/A',\n    fulfillmentAddress: orderData.fulfillments?.[0]?.location?.address || 'N/A',\n    \n    // Datos de la transacción\n    transactionGateway: orderData.transactions?.[0]?.formattedGateway || 'N/A',\n    transactionKind: orderData.transactions?.[0]?.kind || 'N/A',\n    transactionStatus: orderData.transactions?.[0]?.status || 'N/A',\n};\n\n// 4. Iterar sobre los productos y fusionar (incluyendo el costo encontrado)\nconst combinedItems = [];\n\nfor (const productData of productRows) {\n    \n    // Buscamos si existe un costo guardado para este SKU\n    const sku = productData.sku;\n    const unitCost = costMap[sku] || '0.00'; // Si no encuentra match, pone 0.00 o N/A\n\n    const combinedItem = {\n        ...baseOrderData,\n        \n        product: {\n            ID_documento: productData.ID_documento,\n            numero_fila: productData.numero_fila,\n            product_name: productData.product_name,\n            sku: productData.sku,\n            variant_title: productData.variant_title,\n            original_price: productData.original_price,\n            total_discount_applied: productData.total_discount_applied,\n            final_paid_price: productData.final_paid_price,\n            currency: productData.currency,\n            // Aquí agregamos el campo solicitado\n            unit_cost: unitCost \n        }\n    };\n    \n    combinedItems.push({\n        json: combinedItem,\n    });\n}\n\nreturn combinedItems;"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          992,
          480
        ],
        "id": "38bbf384-1b40-4d4d-b5cc-97d8454a7303",
        "name": "Code in JavaScript1"
      },
      {
        "parameters": {
          "operation": "update",
          "dataTableId": {
            "__rl": true,
            "value": "ghO8HECzTZgPqOqM",
            "mode": "list",
            "cachedResultName": "InformeDiario",
            "cachedResultUrl": "/projects/x5UZcmGQw2OWHuXb/datatables/ghO8HECzTZgPqOqM"
          },
          "filters": {
            "conditions": [
              {
                "keyValue": "1"
              }
            ]
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "ID_Documento": "={{ $json.id }}",
              "Contador": 2,
              "Contador_Alquiler": 2
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "ID_Documento",
                "displayName": "ID_Documento",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Contador",
                "displayName": "Contador",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "number",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Contador_Alquiler",
                "displayName": "Contador_Alquiler",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "number",
                "readOnly": false,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.dataTable",
        "typeVersion": 1,
        "position": [
          800,
          128
        ],
        "id": "954c39f5-d1ab-48b0-a72f-d98b54032d3b",
        "name": "Update row(s)"
      },
      {
        "parameters": {
          "operation": "get",
          "dataTableId": {
            "__rl": true,
            "value": "ghO8HECzTZgPqOqM",
            "mode": "list",
            "cachedResultName": "InformeDiario",
            "cachedResultUrl": "/projects/x5UZcmGQw2OWHuXb/datatables/ghO8HECzTZgPqOqM"
          },
          "filters": {
            "conditions": [
              {
                "keyValue": "1"
              }
            ]
          }
        },
        "type": "n8n-nodes-base.dataTable",
        "typeVersion": 1,
        "position": [
          416,
          480
        ],
        "id": "4f754bc8-b2f2-4dd8-a946-e584b5dab050",
        "name": "Get row(s)"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "={{ $json.ID_DOCUMENTO}}",
            "mode": "id"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Hoja 1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/19bvtVxQK6uMbxP2HZKgGEGM_KWyvJM3vLp1APRSSTEY/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $json.NUMERO_FILA }}",
              "SUCURSAL DE VENTA": "={{ $json['SUCURSAL DE VENTA'] }}",
              "MÉTODO DE PAGO": "={{ $json['METODO DE PAGO'] }}",
              "COSTE POR UNIDAD": "={{ $json['COSTO POR UNIDAD'] }}",
              "PRECIO DE PRODUCTO": "={{ $json['COSTE DE PRODUCTO'] }}",
              "PRECIO PAGADO": "={{ $json['PRECIO PAGADO'] }}",
              "DESCUENTO": "={{ $json.DESCUENTO }}",
              "NOMBRE DE PRODUCTO": "={{ $json['NOMBRE DE PRODUCTO'] }}",
              "VARIANTE": "={{ $json.VARIANTE }}"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "SUCURSAL DE VENTA",
                "displayName": "SUCURSAL DE VENTA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "MÉTODO DE PAGO",
                "displayName": "MÉTODO DE PAGO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "COSTE POR UNIDAD",
                "displayName": "COSTE POR UNIDAD",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "PRECIO DE PRODUCTO",
                "displayName": "PRECIO DE PRODUCTO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "PRECIO PAGADO",
                "displayName": "PRECIO PAGADO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "DESCUENTO",
                "displayName": "DESCUENTO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "NOMBRE DE PRODUCTO",
                "displayName": "NOMBRE DE PRODUCTO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "VARIANTE",
                "displayName": "VARIANTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "SURFIN SIERRA NEVADA",
                "displayName": "SURFIN SIERRA NEVADA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Tarjeta",
                "displayName": "Tarjeta",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Efectivo",
                "displayName": "Efectivo",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Venta Web",
                "displayName": "Venta Web",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "TOTAL",
                "displayName": "TOTAL",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "number",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          1280,
          480
        ],
        "id": "3456907e-1889-4e9d-87b5-40ea7f7453de",
        "name": "Update row in sheet",
        "executeOnce": false,
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "RCuKUCifcA4jENcY",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "operation": "update",
          "dataTableId": {
            "__rl": true,
            "value": "ghO8HECzTZgPqOqM",
            "mode": "list",
            "cachedResultName": "InformeDiario",
            "cachedResultUrl": "/projects/x5UZcmGQw2OWHuXb/datatables/ghO8HECzTZgPqOqM"
          },
          "filters": {
            "conditions": [
              {
                "keyValue": "1"
              }
            ]
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "ID_Documento": "={{ $('Edit Fields').item.json.ID_DOCUMENTO }}",
              "Contador": "={{ $('Edit Fields').item.json.NUMERO_FILA  + 1}}"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "ID_Documento",
                "displayName": "ID_Documento",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Contador",
                "displayName": "Contador",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "number",
                "readOnly": false,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.dataTable",
        "typeVersion": 1,
        "position": [
          1440,
          480
        ],
        "id": "faf01950-eda5-4601-8b6c-75240e769c87",
        "name": "Update row(s)1"
      },
      {
        "parameters": {
          "authentication": "headerAuth",
          "endpoint": "https://rulesshop.myshopify.com/admin/api/2024-07/graphql.json",
          "query": "query getVariantCost($id: ID!) {\n  productVariant(id: $id) {\n    id\n    sku\n    title\n    inventoryItem {\n      id\n      unitCost {\n        amount\n        currencyCode\n      }\n    }\n  }\n}\n\n",
          "variables": "={\n  \"id\": \"{{ $json['ID VARIANTE'] }}\"\n}",
          "headerParametersUi": {
            "parameter": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        },
        "type": "n8n-nodes-base.graphql",
        "typeVersion": 1.1,
        "position": [
          688,
          336
        ],
        "id": "0547d26f-e2d4-4a83-ad9a-3b3f4097a3c2",
        "name": "GraphQL1",
        "credentials": {
          "httpHeaderAuth": {
            "id": "OPt2Cl0dnwcU4qRk",
            "name": "ShopifyInformes"
          }
        }
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "711be730-983a-47e6-99f2-d818a44482be",
                "name": "ID VARIANTE",
                "value": "=gid://shopify/ProductVariant/{{ $('Webhook').item.json.body.line_items[0].variant_id }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          576,
          336
        ],
        "id": "296715bd-4cb8-4930-a0d7-966761cc3f3b",
        "name": "Edit Fields1"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "87a5aeba-2adf-47d1-8d7b-b55d5016266a",
                "name": "FECHA",
                "value": "={{ $today }}",
                "type": "object"
              }
            ]
          },
          "options": {
            "ignoreConversionErrors": true
          }
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          368,
          128
        ],
        "id": "fccdf808-f4e0-4782-a70b-a6b6e00c2e42",
        "name": "obtener fecha"
      },
      {
        "parameters": {
          "jsCode": "return items.map(item => {\n  const fecha = new Date(item.json.FECHA);\n\n  const dia = String(fecha.getDate()).padStart(2, '0');\n  const mes = String(fecha.getMonth() + 1).padStart(2, '0');\n  const anio = fecha.getFullYear();\n\n  item.json.FECHA = `${dia}/${mes}/${anio}`;\n\n  return item;\n});\n"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          512,
          128
        ],
        "id": "a2ae42c0-c272-4555-ae7f-445636e14ba8",
        "name": "formatear fecha"
      },
      {
        "parameters": {
          "content": "ACTUALIZAR DOCUMENTO CON CADA PEDIDO",
          "height": 448,
          "width": 1456,
          "color": 3
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          192,
          304
        ],
        "id": "851e0c70-842c-46c7-a56a-b490e4cc792d",
        "name": "Sticky Note"
      },
      {
        "parameters": {
          "sendTo": "emilianomartinezvrd@gmail.com",
          "subject": "Informe diario mamawebaso",
          "message": "=<div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; color: #333333;\">\n  \n  <h2 style=\"color: #2c3e50; border-bottom: 2px solid #007bff; padding-bottom: 10px;\">\n    INFORME DIARIO ({{ $now.toFormat('dd/MM/yyyy') }})\n  </h2>\n\n  <p>Hola,</p>\n  \n  <p>Aquí tienes el informe actualizado correspondiente al día de hoy.</p>\n  <p>Puedes acceder al archivo o recurso haciendo clic en el siguiente botón:</p>\n\n  <div style=\"margin: 30px 0;\">\n    <a href=\"https://docs.google.com/spreadsheets/d/{{ $json.ID_Documento }}/edit?gid=0#gid=0\" \n       style=\"background-color: #007bff; color: #ffffff; padding: 12px 24px; text-decoration: none; border-radius: 5px; font-weight: bold; display: inline-block;\">\n       VER DOCUMENTO\n    </a>\n  </div>\n\n  <p style=\"font-size: 12px; color: #888;\">\n    Este es un mensaje automático enviado por tu flujo de n8n.\n  </p>\n  \n</div>",
          "options": {}
        },
        "type": "n8n-nodes-base.gmail",
        "typeVersion": 2.2,
        "position": [
          384,
          816
        ],
        "id": "e0a1443f-7789-45c3-88a0-4471df57e63a",
        "name": "Send a message",
        "webhookId": "395b376a-113e-4e7e-b92d-4afaa0028904",
        "credentials": {
          "gmailOAuth2": {
            "id": "wR7U82S8bmDH4odC",
            "name": "info@tailwind.es"
          }
        }
      },
      {
        "parameters": {
          "operation": "get",
          "dataTableId": {
            "__rl": true,
            "value": "ghO8HECzTZgPqOqM",
            "mode": "list",
            "cachedResultName": "InformeDiario",
            "cachedResultUrl": "/projects/x5UZcmGQw2OWHuXb/datatables/ghO8HECzTZgPqOqM"
          },
          "filters": {
            "conditions": [
              {
                "keyValue": "1"
              }
            ]
          }
        },
        "type": "n8n-nodes-base.dataTable",
        "typeVersion": 1.1,
        "position": [
          224,
          816
        ],
        "id": "6762e93d-c33c-4008-9d9c-7fd70d47fbf5",
        "name": "Get row(s)1"
      },
      {
        "parameters": {
          "rules": {
            "values": [
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 3
                  },
                  "conditions": [
                    {
                      "leftValue": "={{ $('Correo').item.json.from.text }}",
                      "rightValue": "=reservas@rules-shop.es",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "id": "5702ef6b-4e43-4933-9af3-abf329de5e06"
                    }
                  ],
                  "combinator": "and"
                }
              },
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 3
                  },
                  "conditions": [
                    {
                      "id": "1384d8f9-c75c-4be1-a293-98c0d102292b",
                      "leftValue": "={{ $('Correo').item.json.from.text }}",
                      "rightValue": "reservas@surfin.es",
                      "operator": {
                        "type": "string",
                        "operation": "equals",
                        "name": "filter.operator.equals"
                      }
                    }
                  ],
                  "combinator": "and"
                }
              },
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 3
                  },
                  "conditions": [
                    {
                      "id": "fe1d90fc-f649-48e8-9f37-c58ef22f10c7",
                      "leftValue": "={{ $('Correo').item.json.from.text }}",
                      "rightValue": "reservas@snowdivision.es",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      }
                    }
                  ],
                  "combinator": "and"
                }
              },
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 3
                  },
                  "conditions": [
                    {
                      "id": "06d5176e-59be-4584-9efb-c8a5f233789c",
                      "leftValue": "={{ $('Correo').item.json.from.value[0].address }}",
                      "rightValue": "info@sierranevadagranada.com",
                      "operator": {
                        "type": "string",
                        "operation": "equals",
                        "name": "filter.operator.equals"
                      }
                    }
                  ],
                  "combinator": "and"
                }
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.switch",
        "typeVersion": 3.4,
        "position": [
          -656,
          448
        ],
        "id": "fa3ccb4f-aef5-4d7b-a691-90267f5171fe",
        "name": "Switch"
      },
      {
        "parameters": {
          "jsCode": "// 1. Accedemos a los datos del email original\nconst correoOriginal = $('Correo').item.json;\nconst subject = (correoOriginal.subject || \"\").replace(/\\n/g, ' ').trim();\nconst bodyText = correoOriginal.text || \"\";\n\n// 2. Accedemos al contador base\nconst datosPrevios = $input.first().json;\nconst contadorBase = parseInt(datosPrevios.Contador_Alquiler) || 0;\n\n// 3. Identificar Marca\nlet marca = \"Rules\";\nif (subject.toLowerCase().includes(\"surfin\")) marca = \"Surfin\";\nif (subject.toLowerCase().includes(\"snow division\")) marca = \"Snow Division\";\n\n// 4. Extraer Datos del Cliente\nlet nombreCompleto = \"No encontrado\";\nconst partesAsunto = subject.split(\" - \");\nif (partesAsunto.length >= 3) {\n    nombreCompleto = partesAsunto[2].trim();\n}\nconst nombrePartes = nombreCompleto.split(\" \");\nconst nombre = nombrePartes[0].replace(/\\n/g, '').trim();\nconst apellidos = nombrePartes.slice(1).join(\" \").replace(/\\n/g, '').trim();\nconst clienteEmail = (correoOriginal.to.value[0].address || \"No encontrado\").replace(/\\n/g, '').trim();\n\n// 5. Totales e Identificador\nconst totalMatch = bodyText.match(/TOTAL:\\s*([\\d,.]+)/);\nconst precioTotal = totalMatch ? totalMatch[1].replace(/\\n/g, '').trim() : \"0.00\";\nconst orderMatch = bodyText.match(/Identificador:\\s*\\n*([A-Z0-9]+)/);\nconst idPedido = orderMatch ? orderMatch[1].replace(/\\n/g, '').trim() : \"No encontrado\";\n\n// 6. Canal y Método de Pago\nconst canalMatch = bodyText.match(/Canal:\\s*\\n*([^\\n]+)/);\nconst canalVenta = canalMatch ? canalMatch[1].replace(/\\n/g, ' ').trim() : \"Desconocido\";\nconst pagoMatch = bodyText.match(/Acción requerida\\s+[\\d,.]+€\\s+[\\d/]+\\s+([^\\n\\t]+)\\s+Efectuado/i);\nconst metodoPago = pagoMatch ? pagoMatch[1].replace(/\\n/g, ' ').trim() : \"No encontrado\";\n\n// 7. Extraer y AGRUPAR Productos\nconst productosMap = {};\nconst productRegex = /([A-Z0-9\\sÁÉÍÓÚÑ\\-]{5,})\\n\\n(\\d+)\\s+([\\d,.]+)€/g;\nlet match;\n\nwhile ((match = productRegex.exec(bodyText)) !== null) {\n    // LIMPIEZA: Quitamos saltos de línea del nombre del producto\n    let nombreProd = match[1].replace(/\\n/g, ' ').replace(/\\s+/g, ' ').trim();\n    \n    if (nombreProd.includes(\"2X1\")) nombreProd = \"EQUIPO ESQUÍ 2X1\";\n    const cantidad = parseInt(match[2]);\n    const precioUnitario = match[3].replace(',', '.').replace(/\\n/g, '').trim();\n\n    if (productosMap[nombreProd]) {\n        productosMap[nombreProd].cantidad += cantidad;\n    } else {\n        productosMap[nombreProd] = { nombre: nombreProd, cantidad, precio_unitario: precioUnitario };\n    }\n}\n\n// 8. Generar salida plana\nconst productosArray = Object.values(productosMap);\n// LIMPIEZA: El resumen también sin saltos de línea\nconst resumenTexto = productosArray.map(p => `${p.nombre} x${p.cantidad}`).join(', ').replace(/\\n/g, ' ');\n\nreturn productosArray.map((prod, index) => {\n    const numeroFilaActual = contadorBase + index;\n\n    if (index === 0) {\n        return {\n            \"numero_fila\": numeroFilaActual,\n            \"marca\": marca,\n            \"cliente_nombre\": nombre,\n            \"cliente_apellidos\": apellidos,\n            \"cliente_email\": clienteEmail,\n            \"id_pedido\": idPedido,\n            \"canal\": canalVenta,\n            \"metodo_pago\": metodoPago,\n            \"total_compra\": precioTotal,\n            \"nombre_producto\": prod.nombre, // Ya limpio arriba\n            \"cantidad\": prod.cantidad,\n            \"precio_unitario\": prod.precio_unitario,\n            \"productos_resumen\": resumenTexto\n        };\n    } else {\n        return {\n            \"numero_fila\": numeroFilaActual,\n            \"marca\": \"\",\n            \"cliente_nombre\": \"\",\n            \"cliente_apellidos\": \"\",\n            \"cliente_email\": \"\",\n            \"id_pedido\": \"\",\n            \"canal\": \"\",\n            \"metodo_pago\": \"\",\n            \"total_compra\": \"\",\n            \"nombre_producto\": prod.nombre,\n            \"cantidad\": prod.cantidad,\n            \"precio_unitario\": prod.precio_unitario,\n            \"productos_resumen\": \"\"\n        };\n    }\n});"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -464,
          256
        ],
        "id": "132c4e3b-b445-4f4b-bdff-7374f9e5ff18",
        "name": "rules-shop"
      },
      {
        "parameters": {
          "jsCode": "// 1. Accedemos a los datos del email original\nconst correoOriginal = $('Correo').item.json;\nconst subject = (correoOriginal.subject || \"\").replace(/\\n/g, ' ').trim();\nconst bodyText = correoOriginal.text || \"\";\n\n// 2. Accedemos al contador del nodo anterior\nconst datosPrevios = $input.first().json;\nconst contadorBase = parseInt(datosPrevios.Contador_Alquiler) || 0;\n\n// 3. Extraer Marca\nconst marca = subject.includes(\"Surfin\") ? \"Surfin\" : (subject.includes(\"Snow Division\") ? \"Snow Division\" : \"Rules\");\n\n// 4. Extraer Datos del Cliente\nlet nombreCompleto = \"No indicado\";\nconst partesAsunto = subject.split(\" - \");\nif (partesAsunto.length >= 3 && partesAsunto[2].trim() !== \"\") {\n    nombreCompleto = partesAsunto[2].trim();\n}\n\nconst nombrePartes = nombreCompleto.split(\" \");\nconst nombre = (nombrePartes[0] || \"No indicado\").replace(/\\n/g, '').trim();\nconst apellidos = nombrePartes.slice(1).join(\" \").replace(/\\n/g, '').trim();\n\nconst clienteEmail = (correoOriginal.to?.value?.[0]?.address || correoOriginal.from?.value?.[0]?.address || \"No encontrado\").replace(/\\n/g, '').trim();\n\n// 5. Totales e Identificador\nconst totalMatch = bodyText.match(/TOTAL:\\s*([\\d,.]+)/);\nconst precioTotal = totalMatch ? totalMatch[1].replace(/\\n/g, '').trim() : \"0.00\";\nconst orderMatch = bodyText.match(/Identificador:\\s*\\n*([A-Z0-9]+)/);\nconst idPedido = orderMatch ? orderMatch[1].replace(/\\n/g, '').trim() : \"No encontrado\";\n\n// 6. Canal y Método de Pago\nconst canalMatch = bodyText.match(/Canal:\\s*\\n*([^\\n]+)/);\nconst canalVenta = canalMatch ? canalMatch[1].replace(/\\n/g, ' ').trim() : \"Desconocido\";\n\nconst pagoMatch = bodyText.match(/Acción requerida\\s+[\\d,.]+€\\s+[\\d/]+\\s+([^\\n\\t]+)\\s+Efectuado/i);\nconst metodoPago = pagoMatch ? pagoMatch[1].replace(/\\n/g, ' ').trim() : \"No encontrado\";\n\n// 7. Extraer y AGRUPAR Productos\nconst productosMap = {};\nconst productRegex = /PRODUCTO\\n\\n(\\d+)\\s+([\\d,.]+)€\\n\\nLocalizador:\\s*([a-z0-9]+)\\nConcepto:\\s*([^\\n]+)/gi;\nlet match;\n\nwhile ((match = productRegex.exec(bodyText)) !== null) {\n    // LIMPIEZA: Quitamos saltos de línea y normalizamos espacios\n    let nombreProd = match[4].replace(/\\n/g, ' ').replace(/\\s+/g, ' ').trim().toUpperCase();\n    const cantidad = parseInt(match[1]);\n    const precioUnitario = match[2].replace(',', '.').replace(/\\n/g, '').trim();\n\n    if (productosMap[nombreProd]) {\n        productosMap[nombreProd].cantidad += cantidad;\n    } else {\n        productosMap[nombreProd] = { nombre: nombreProd, cantidad, precio_unitario: precioUnitario };\n    }\n}\n\n// 8. Fallback si el anterior no captura nada\nif (Object.keys(productosMap).length === 0) {\n    const fallbackRegex = /([A-Z0-9\\sÁÉÍÓÚÑ\\-]{5,})\\n\\n(\\d+)\\s+([\\d,.]+)€/g;\n    let fallbackMatch;\n    while ((fallbackMatch = fallbackRegex.exec(bodyText)) !== null) {\n        // LIMPIEZA: También en el fallback\n        let nProd = fallbackMatch[1].replace(/\\n/g, ' ').replace(/\\s+/g, ' ').trim();\n        if (nProd.includes(\"2X1\")) nProd = \"EQUIPO ESQUÍ 2X1\";\n        const cant = parseInt(fallbackMatch[2]);\n        const prec = fallbackMatch[3].replace(',', '.').replace(/\\n/g, '').trim();\n        if (productosMap[nProd]) productosMap[nProd].cantidad += cant;\n        else productosMap[nProd] = { nombre: nProd, cantidad: cant, precio_unitario: prec };\n    }\n}\n\n// 9. CREAR SALIDA DIFERENCIADA\nconst productosArray = Object.values(productosMap);\nconst resumenTexto = productosArray.map(p => `${p.nombre} x${p.cantidad}`).join(', ').replace(/\\n/g, ' ');\n\nif (productosArray.length === 0) {\n    productosArray.push({ nombre: \"PRODUCTO NO DETECTADO\", cantidad: 1, precio_unitario: \"0.00\" });\n}\n\nreturn productosArray.map((prod, index) => {\n    const numeroFilaActual = contadorBase + index;\n\n    if (index === 0) {\n        return {\n            \"numero_fila\": numeroFilaActual,\n            \"MARCA\": marca,\n            \"NOMBRE CLIENTE\": nombre,\n            \"APELLIDOS\": apellidos,\n            \"ID PEDIDO\": idPedido,\n            \"EMAIL\": clienteEmail,\n            \"CANAL\": canalVenta,\n            \"MÉTODO DE PAGO\": metodoPago,\n            \"TOTAL COMPRA (+IVA)\": precioTotal,\n            \"NOMBRE PRODUCTO\": prod.nombre,\n            \"CANTIDAD\": prod.cantidad,\n            \"PRECIO UNITARIO\": prod.precio_unitario,\n            \"RESUMEN\": resumenTexto\n        };\n    } else {\n        return {\n            \"numero_fila\": numeroFilaActual,\n            \"MARCA\": \"\", \n            \"NOMBRE CLIENTE\": \"\",\n            \"APELLIDOS\": \"\",\n            \"ID PEDIDO\": \"\",\n            \"EMAIL\": \"\",\n            \"CANAL\": \"\",\n            \"MÉTODO DE PAGO\": \"\",\n            \"TOTAL COMPRA (+IVA)\": \"\",\n            \"NOMBRE PRODUCTO\": prod.nombre,\n            \"CANTIDAD\": prod.cantidad,\n            \"PRECIO UNITARIO\": prod.precio_unitario,\n            \"RESUMEN\": \"\"\n        };\n    }\n});"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -464,
          400
        ],
        "id": "d58a6580-401b-4d55-bc2f-a2bcb34c3ee5",
        "name": "surfin"
      },
      {
        "parameters": {
          "jsCode": "// 1. Accedemos a los datos del email original\nconst correoOriginal = $('Correo').item.json;\nconst subject = (correoOriginal.subject || \"\").replace(/\\n/g, ' ').trim();\nconst bodyText = correoOriginal.text || \"\";\n\n// 2. Accedemos al contador base del nodo anterior\nconst datosPrevios = $input.first().json;\nconst contadorBase = parseInt(datosPrevios.Contador_Alquiler) || 0; \n\n// 3. Identificar Marca\nlet marca = \"Rules\";\nif (subject.toLowerCase().includes(\"surfin\")) marca = \"Surfin\";\nif (subject.toLowerCase().includes(\"snow division\")) marca = \"Snow Division\";\n\n// 4. Extraer Datos del Cliente\nlet nombreCompleto = \"No encontrado\";\nconst partesAsunto = subject.split(\" - \");\nif (partesAsunto.length >= 3) {\n    nombreCompleto = partesAsunto[2].trim();\n}\nconst nombrePartes = nombreCompleto.split(\" \");\nconst nombre = (nombrePartes[0] || \"\").replace(/\\n/g, '').trim();\nconst apellidos = nombrePartes.slice(1).join(\" \").replace(/\\n/g, '').trim();\nconst clienteEmail = (correoOriginal.to.value[0].address || \"No encontrado\").replace(/\\n/g, '').trim();\n\n// 5. Totales e Identificador\nconst totalMatch = bodyText.match(/TOTAL:\\s*([\\d,.]+)/);\nconst precioTotal = totalMatch ? totalMatch[1].replace(/\\n/g, '').trim() : \"0.00\";\nconst orderMatch = bodyText.match(/Identificador:\\s*\\n*([A-Z0-9]+)/);\nconst idPedido = orderMatch ? orderMatch[1].replace(/\\n/g, '').trim() : \"No encontrado\";\n\n// 6. Canal y Método de Pago\nconst canalMatch = bodyText.match(/Canal:\\s*\\n*([^\\n]+)/);\nconst canalVenta = canalMatch ? canalMatch[1].replace(/\\n/g, ' ').trim() : \"Desconocido\";\nconst pagoMatch = bodyText.match(/Acción requerida\\s+[\\d,.]+€\\s+[\\d/]+\\s+([^\\n\\t]+)\\s+Efectuado/i);\nconst metodoPago = pagoMatch ? pagoMatch[1].replace(/\\n/g, ' ').trim() : \"No encontrado\";\n\n// 7. Extraer y AGRUPAR Productos\nconst productosMap = {};\nconst productRegex = /([A-Z0-9\\sÁÉÍÓÚÑ\\-]{5,})\\n\\n(\\d+)\\s+([\\d,.]+)€/g;\nlet match;\n\nwhile ((match = productRegex.exec(bodyText)) !== null) {\n    // LIMPIEZA: Eliminamos saltos de línea y colapsamos espacios múltiples en el nombre del producto\n    let nombreProd = match[1].replace(/\\n/g, ' ').replace(/\\s+/g, ' ').trim();\n    \n    if (nombreProd.includes(\"2X1\")) nombreProd = \"EQUIPO ESQUÍ 2X1\";\n    const cantidad = parseInt(match[2]);\n    const precioUnitario = match[3].replace(',', '.').replace(/\\n/g, '').trim();\n\n    if (productosMap[nombreProd]) {\n        productosMap[nombreProd].cantidad += cantidad;\n    } else {\n        productosMap[nombreProd] = { nombre: nombreProd, cantidad, precio_unitario: precioUnitario };\n    }\n}\n\n// 8. Generar salida plana para Google Sheets\nconst productosArray = Object.values(productosMap);\n// LIMPIEZA: Resumen sin saltos de línea para que no rompa la celda\nconst resumenTexto = productosArray.map(p => `${p.nombre} x${p.cantidad}`).join(', ').replace(/\\n/g, ' ');\n\nreturn productosArray.map((prod, index) => {\n    const numeroFilaActual = contadorBase + index;\n\n    if (index === 0) {\n        return {\n            \"numero_fila\": numeroFilaActual,\n            \"marca\": marca,\n            \"cliente_nombre\": nombre,\n            \"cliente_apellidos\": apellidos,\n            \"cliente_email\": clienteEmail,\n            \"id_pedido\": idPedido,\n            \"canal\": canalVenta,\n            \"metodo_pago\": metodoPago,\n            \"total_compra\": precioTotal,\n            \"nombre_producto\": prod.nombre,\n            \"cantidad\": prod.cantidad,\n            \"precio_unitario\": prod.precio_unitario,\n            \"productos_resumen\": resumenTexto\n        };\n    } else {\n        return {\n            \"numero_fila\": numeroFilaActual,\n            \"marca\": \"\",\n            \"cliente_nombre\": \"\",\n            \"cliente_apellidos\": \"\",\n            \"cliente_email\": \"\",\n            \"id_pedido\": \"\",\n            \"canal\": \"\",\n            \"metodo_pago\": \"\",\n            \"total_compra\": \"\",\n            \"nombre_producto\": prod.nombre,\n            \"cantidad\": prod.cantidad,\n            \"precio_unitario\": prod.precio_unitario,\n            \"productos_resumen\": \"\"\n        };\n    }\n});"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -464,
          544
        ],
        "id": "9031743d-79e1-4b7d-a852-e3aa8b68164a",
        "name": "snowdivision"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "={{ $('Get row(s)2').item.json.ID_Documento }}",
            "mode": "id"
          },
          "sheetName": {
            "__rl": true,
            "value": "Alquiler",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "MARCA": "={{ $json.marca }}",
              "NOMBRE CLIENTE": "={{ $json.cliente_nombre }}",
              "APELLIDOS CLIENTE": "={{ $json.cliente_apellidos }}",
              "EMAIL": "={{ $json.cliente_email }}",
              "ID PEDIDO": "={{ $json.id_pedido }}",
              "CANAL": "={{ $json.canal }}",
              "MÉTODO DE PAGO": "={{ $json.metodo_pago }}",
              "TOTAL COMPRA (+IVA)": "={{ $json.total_compra }}",
              "NOMBRE PRODUCTO": "={{ $json.nombre_producto }}",
              "CANTIDAD": "={{ $json.cantidad }}",
              "PRECIO UNITARIO": "={{ $json.precio_unitario }}",
              "RESUMEN": "={{ $json.productos_resumen }}",
              "row_number": "={{ $json.numero_fila }}"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "MARCA",
                "displayName": "MARCA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "NOMBRE CLIENTE",
                "displayName": "NOMBRE CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "APELLIDOS CLIENTE",
                "displayName": "APELLIDOS CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "EMAIL",
                "displayName": "EMAIL",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "ID PEDIDO",
                "displayName": "ID PEDIDO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "CANAL",
                "displayName": "CANAL",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "MÉTODO DE PAGO",
                "displayName": "MÉTODO DE PAGO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "TOTAL COMPRA (+IVA)",
                "displayName": "TOTAL COMPRA (+IVA)",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "NOMBRE PRODUCTO",
                "displayName": "NOMBRE PRODUCTO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "CANTIDAD",
                "displayName": "CANTIDAD",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "PRECIO UNITARIO",
                "displayName": "PRECIO UNITARIO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "RESUMEN",
                "displayName": "RESUMEN",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "number",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          -288,
          544
        ],
        "id": "7367a66d-8df9-476b-8c0b-5479607fb339",
        "name": "Escribir SnowDivision",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "RCuKUCifcA4jENcY",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "={{ $('Get row(s)2').item.json.ID_Documento }}",
            "mode": "id"
          },
          "sheetName": {
            "__rl": true,
            "value": "Alquiler",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "MARCA": "={{ $json.marca }}",
              "row_number": "={{ $json.numero_fila }}",
              "NOMBRE CLIENTE": "={{ $json.nombre_cliente }}",
              "APELLIDOS CLIENTE": "={{ $json.cliente_apellidos }}",
              "EMAIL": "={{ $json.cliente_email }}",
              "ID PEDIDO": "={{ $json.id_pedido }}",
              "CANAL": "={{ $json.canal }}",
              "MÉTODO DE PAGO": "={{ $json.metodo_pago }}",
              "TOTAL COMPRA (+IVA)": "={{ $json.total_compra }}",
              "NOMBRE PRODUCTO": "={{ $json.nombre_producto }}",
              "CANTIDAD": "={{ $json.cantidad }}",
              "PRECIO UNITARIO": "={{ $json.precio_unitario }}",
              "RESUMEN": "={{ $json.productos_resumen }}"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "MARCA",
                "displayName": "MARCA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "NOMBRE CLIENTE",
                "displayName": "NOMBRE CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "APELLIDOS CLIENTE",
                "displayName": "APELLIDOS CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "EMAIL",
                "displayName": "EMAIL",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "ID PEDIDO",
                "displayName": "ID PEDIDO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "CANAL",
                "displayName": "CANAL",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "MÉTODO DE PAGO",
                "displayName": "MÉTODO DE PAGO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "TOTAL COMPRA (+IVA)",
                "displayName": "TOTAL COMPRA (+IVA)",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "NOMBRE PRODUCTO",
                "displayName": "NOMBRE PRODUCTO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "CANTIDAD",
                "displayName": "CANTIDAD",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "PRECIO UNITARIO",
                "displayName": "PRECIO UNITARIO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "RESUMEN",
                "displayName": "RESUMEN",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "number",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          -288,
          400
        ],
        "id": "e4cb0885-b4e6-46e5-abc8-ced7e117233d",
        "name": "Escribir Surfin",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "RCuKUCifcA4jENcY",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "={{ $('Get row(s)2').item.json.ID_Documento }}",
            "mode": "id"
          },
          "sheetName": {
            "__rl": true,
            "value": "Alquiler",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $json.numero_fila }}",
              "MARCA": "={{ $json.marca }}",
              "NOMBRE CLIENTE": "={{ $json.cliente_nombre }}",
              "APELLIDOS CLIENTE": "={{ $json.cliente_apellidos }}",
              "EMAIL": "={{ $json.cliente_email }}",
              "ID PEDIDO": "={{ $json.id_pedido }}",
              "CANAL": "={{ $json.canal }}",
              "MÉTODO DE PAGO": "={{ $json.metodo_pago }}",
              "TOTAL COMPRA (+IVA)": "={{ $json.total_compra }}",
              "NOMBRE PRODUCTO": "={{ $json.nombre_producto }}",
              "CANTIDAD": "={{ $json.cantidad }}",
              "PRECIO UNITARIO": "={{ $json.precio_unitario }}",
              "RESUMEN": "={{ $json.productos_resumen }}"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "MARCA",
                "displayName": "MARCA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "NOMBRE CLIENTE",
                "displayName": "NOMBRE CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "APELLIDOS CLIENTE",
                "displayName": "APELLIDOS CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "EMAIL",
                "displayName": "EMAIL",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "ID PEDIDO",
                "displayName": "ID PEDIDO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "CANAL",
                "displayName": "CANAL",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "MÉTODO DE PAGO",
                "displayName": "MÉTODO DE PAGO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "TOTAL COMPRA (+IVA)",
                "displayName": "TOTAL COMPRA (+IVA)",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "NOMBRE PRODUCTO",
                "displayName": "NOMBRE PRODUCTO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "CANTIDAD",
                "displayName": "CANTIDAD",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "PRECIO UNITARIO",
                "displayName": "PRECIO UNITARIO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "RESUMEN",
                "displayName": "RESUMEN",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "number",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          -288,
          256
        ],
        "id": "9262d50b-9185-4607-81c6-ad91edd89465",
        "name": "Escribir Rules",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "RCuKUCifcA4jENcY",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "operation": "update",
          "dataTableId": {
            "__rl": true,
            "value": "ghO8HECzTZgPqOqM",
            "mode": "list",
            "cachedResultName": "InformeDiario",
            "cachedResultUrl": "/projects/x5UZcmGQw2OWHuXb/datatables/ghO8HECzTZgPqOqM"
          },
          "filters": {
            "conditions": [
              {
                "keyValue": "1"
              }
            ]
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "Contador_Alquiler": "={{ $json.row_number + 1}}",
              "Contador": "={{ $('Get row(s)2').item.json.Contador }}"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "ID_Documento",
                "displayName": "ID_Documento",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Contador",
                "displayName": "Contador",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "number",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Contador_Alquiler",
                "displayName": "Contador_Alquiler",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "number",
                "readOnly": false,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.dataTable",
        "typeVersion": 1.1,
        "position": [
          -128,
          256
        ],
        "id": "520dc12b-583c-40bd-80d8-b54401ade2f1",
        "name": "actualizar contador rules"
      },
      {
        "parameters": {
          "operation": "update",
          "dataTableId": {
            "__rl": true,
            "value": "ghO8HECzTZgPqOqM",
            "mode": "list",
            "cachedResultName": "InformeDiario",
            "cachedResultUrl": "/projects/x5UZcmGQw2OWHuXb/datatables/ghO8HECzTZgPqOqM"
          },
          "filters": {
            "conditions": [
              {
                "keyValue": "1"
              }
            ]
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "Contador_Alquiler": "={{ $json.row_number + 1}}",
              "Contador": "={{ $('Get row(s)2').item.json.Contador }}"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "ID_Documento",
                "displayName": "ID_Documento",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Contador",
                "displayName": "Contador",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "number",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Contador_Alquiler",
                "displayName": "Contador_Alquiler",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "number",
                "readOnly": false,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.dataTable",
        "typeVersion": 1.1,
        "position": [
          -128,
          400
        ],
        "id": "6b0db584-2a39-46bb-902d-9131fa4ce1e0",
        "name": "actualizar contador surfin"
      },
      {
        "parameters": {
          "operation": "update",
          "dataTableId": {
            "__rl": true,
            "value": "ghO8HECzTZgPqOqM",
            "mode": "list",
            "cachedResultName": "InformeDiario",
            "cachedResultUrl": "/projects/x5UZcmGQw2OWHuXb/datatables/ghO8HECzTZgPqOqM"
          },
          "filters": {
            "conditions": [
              {
                "keyValue": "1"
              }
            ]
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "Contador_Alquiler": "={{ $json.row_number + 1}}",
              "Contador": "={{ $('Get row(s)2').item.json.Contador }}"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "ID_Documento",
                "displayName": "ID_Documento",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Contador",
                "displayName": "Contador",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "number",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Contador_Alquiler",
                "displayName": "Contador_Alquiler",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "number",
                "readOnly": false,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {
            "dryRun": false
          }
        },
        "type": "n8n-nodes-base.dataTable",
        "typeVersion": 1.1,
        "position": [
          -128,
          544
        ],
        "id": "56f1f664-3f3e-480a-84a8-f9067fb0d648",
        "name": "actualizar contador snowdivision"
      },
      {
        "parameters": {
          "jsCode": "// 1. Accedemos a los datos del email original del nodo \"Correo\"\nconst correoOriginal = $('Correo').item.json;\nconst subject = (correoOriginal.subject || \"\").replace(/\\n/g, ' ').trim();\nconst bodyText = correoOriginal.text || \"\";\n\n// 2. Accedemos al contador base del nodo anterior ($input)\nconst datosPrevios = $input.first().json;\nconst contadorBase = parseInt(datosPrevios.Contador_Alquiler) || 0;\n\n// 3. Extraer Marca (Sierra Nevada Granada)\nlet marca = \"Sierra Nevada Granada\";\n\n// 4. Extraer Datos del Cliente del Subject\nlet nombreCompleto = \"No encontrado\";\nconst partesAsunto = subject.split(\" - \");\nif (partesAsunto.length >= 2) {\n    nombreCompleto = partesAsunto[1].trim();\n}\nconst nombrePartes = nombreCompleto.split(\" \");\nconst nombre = (nombrePartes[0] || \"\").replace(/\\n/g, '').trim();\nconst apellidos = nombrePartes.slice(1).join(\" \").replace(/\\n/g, '').trim();\nconst clienteEmail = (correoOriginal.from?.value?.[0]?.address || \"No encontrado\").replace(/\\n/g, '').trim();\n\n// 5. Identificador del Pedido (Número: SO...)\nconst orderMatch = bodyText.match(/N[úu]mero:\\s*(SO\\d+)/i);\nconst idPedido = orderMatch ? orderMatch[1].replace(/\\n/g, '').trim() : \"No encontrado\";\n\n// 6. Canal de Venta\nconst canalVenta = partesAsunto[2] ? partesAsunto[2].replace(\"canal \", \"\").replace(/\\n/g, ' ').trim() : \"Reservas\";\n\n// 7. Extraer y AGRUPAR Productos\nconst productosMap = {};\n\n/** * Regex para el formato Sierra Nevada: Limpia saltos de línea dentro del nombre\n */\nconst productRegex = /Descripci[óo]n\\s+Cant\\.\\s+([\\w\\sÁÉÍÓÚÑ\\-]+?)\\s+(\\d+[\\d,.]*)/g;\nlet match;\n\nwhile ((match = productRegex.exec(bodyText)) !== null) {\n    // LIMPIEZA: Quitamos saltos de línea y espacios múltiples del nombre del producto\n    let nombreProd = match[1].replace(/\\n/g, ' ').replace(/\\s+/g, ' ').trim();\n    nombreProd = nombreProd.split('  ')[0].trim(); // Evita capturar cabeceras si se filtran\n    \n    const cantidad = parseInt(match[2].split(',')[0]);\n\n    if (productosMap[nombreProd]) {\n        productosMap[nombreProd].cantidad += cantidad;\n    } else {\n        productosMap[nombreProd] = { \n            nombre: nombreProd, \n            cantidad: cantidad, \n            precio_unitario: \"Ver email\" \n        };\n    }\n}\n\n// 8. Búsqueda de emergencia para Forfaits (limpia también)\nif (Object.keys(productosMap).length === 0) {\n    const forfaitMatch = bodyText.match(/Forfait\\s+D[íi]as\\s+Consecutivos/i);\n    if (forfaitMatch) {\n        productosMap[\"FORFAIT DÍAS CONSECUTIVOS\"] = { nombre: \"FORFAIT DÍAS CONSECUTIVOS\", cantidad: 1, precio_unitario: \"Ver email\" };\n    }\n}\n\n// 9. Generar salida para Google Sheets\nconst productosArray = Object.values(productosMap);\n// Resumen unificado en una sola línea\nconst resumenTexto = productosArray.map(p => `${p.nombre} x${p.cantidad}`).join(', ').replace(/\\n/g, ' ');\n\nif (productosArray.length === 0) {\n    productosArray.push({ nombre: \"PRODUCTO NO DETECTADO\", cantidad: 1, precio_unitario: \"Ver email\" });\n}\n\nreturn productosArray.map((prod, index) => {\n    const numeroFilaActual = contadorBase + index;\n\n    if (index === 0) {\n        return {\n            \"numero_fila\": numeroFilaActual,\n            \"marca\": marca,\n            \"cliente_nombre\": nombre,\n            \"cliente_apellidos\": apellidos,\n            \"cliente_email\": clienteEmail,\n            \"id_pedido\": idPedido,\n            \"canal\": canalVenta,\n            \"metodo_pago\": \"Tarjeta\",\n            \"total_compra\": \"Ver justificante\",\n            \"nombre_producto\": prod.nombre,\n            \"cantidad\": prod.cantidad,\n            \"precio_unitario\": prod.precio_unitario,\n            \"productos_resumen\": resumenTexto\n        };\n    } else {\n        return {\n            \"numero_fila\": numeroFilaActual,\n            \"marca\": \"\",\n            \"cliente_nombre\": \"\",\n            \"cliente_apellidos\": \"\",\n            \"cliente_email\": \"\",\n            \"id_pedido\": \"\",\n            \"canal\": \"\",\n            \"metodo_pago\": \"\",\n            \"total_compra\": \"\",\n            \"nombre_producto\": prod.nombre,\n            \"cantidad\": prod.cantidad,\n            \"precio_unitario\": prod.precio_unitario,\n            \"productos_resumen\": \"\"\n        };\n    }\n});"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -464,
          688
        ],
        "id": "639143ee-f6eb-4832-af8e-48d41053a656",
        "name": "sierranevadagranada"
      },
      {
        "parameters": {
          "operation": "update",
          "documentId": {
            "__rl": true,
            "value": "={{ $('Get row(s)2').item.json.ID_Documento }}",
            "mode": "id"
          },
          "sheetName": {
            "__rl": true,
            "value": "Alquiler",
            "mode": "name"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "row_number": "={{ $json.numero_fila }}",
              "MARCA": "={{ $json.marca }}",
              "NOMBRE CLIENTE": "={{ $json.cliente_nombre }}",
              "APELLIDOS CLIENTE": "={{ $json.cliente_apellidos }}",
              "EMAIL": "={{ $json.cliente_email }}",
              "ID PEDIDO": "={{ $json.id_pedido }}",
              "CANAL": "={{ $json.canal }}",
              "MÉTODO DE PAGO": "={{ $json.metodo_pago }}",
              "TOTAL COMPRA (+IVA)": "={{ $json.total_compra }}",
              "NOMBRE PRODUCTO": "={{ $json.nombre_producto }}",
              "CANTIDAD": "={{ $json.cantidad }}",
              "PRECIO UNITARIO": "={{ $json.precio_unitario }}",
              "RESUMEN": "={{ $json.productos_resumen }}"
            },
            "matchingColumns": [
              "row_number"
            ],
            "schema": [
              {
                "id": "MARCA",
                "displayName": "MARCA",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "NOMBRE CLIENTE",
                "displayName": "NOMBRE CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "APELLIDOS CLIENTE",
                "displayName": "APELLIDOS CLIENTE",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "EMAIL",
                "displayName": "EMAIL",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "ID PEDIDO",
                "displayName": "ID PEDIDO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "CANAL",
                "displayName": "CANAL",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "MÉTODO DE PAGO",
                "displayName": "MÉTODO DE PAGO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "TOTAL COMPRA (+IVA)",
                "displayName": "TOTAL COMPRA (+IVA)",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "NOMBRE PRODUCTO",
                "displayName": "NOMBRE PRODUCTO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "CANTIDAD",
                "displayName": "CANTIDAD",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "PRECIO UNITARIO",
                "displayName": "PRECIO UNITARIO",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "RESUMEN",
                "displayName": "RESUMEN",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "row_number",
                "displayName": "row_number",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "number",
                "canBeUsedToMatch": true,
                "readOnly": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.7,
        "position": [
          -288,
          688
        ],
        "id": "bdcbbe12-2485-403b-bbd0-1b060ee75634",
        "name": "Escribir sierranevadagranada",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "RCuKUCifcA4jENcY",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "operation": "update",
          "dataTableId": {
            "__rl": true,
            "value": "ghO8HECzTZgPqOqM",
            "mode": "list",
            "cachedResultName": "InformeDiario",
            "cachedResultUrl": "/projects/x5UZcmGQw2OWHuXb/datatables/ghO8HECzTZgPqOqM"
          },
          "filters": {
            "conditions": [
              {
                "keyValue": "1"
              }
            ]
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "Contador_Alquiler": "={{ $json.row_number + 1}}",
              "Contador": "={{ $('Get row(s)2').item.json.Contador }}"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "ID_Documento",
                "displayName": "ID_Documento",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Contador",
                "displayName": "Contador",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "number",
                "readOnly": false,
                "removed": false
              },
              {
                "id": "Contador_Alquiler",
                "displayName": "Contador_Alquiler",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "number",
                "readOnly": false,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.dataTable",
        "typeVersion": 1.1,
        "position": [
          -128,
          688
        ],
        "id": "f91d9064-be06-467e-a244-f6f1999fc426",
        "name": "actualizar contador sierranevadagranada"
      },
      {
        "parameters": {
          "operation": "get",
          "dataTableId": {
            "__rl": true,
            "value": "ghO8HECzTZgPqOqM",
            "mode": "list",
            "cachedResultName": "InformeDiario",
            "cachedResultUrl": "/projects/x5UZcmGQw2OWHuXb/datatables/ghO8HECzTZgPqOqM"
          },
          "filters": {
            "conditions": [
              {
                "keyValue": "1"
              }
            ]
          }
        },
        "type": "n8n-nodes-base.dataTable",
        "typeVersion": 1.1,
        "position": [
          -816,
          480
        ],
        "id": "162dccd0-13f7-427e-8032-e9547d607c67",
        "name": "Get row(s)2"
      },
      {
        "parameters": {
          "pollTimes": {
            "item": [
              {
                "mode": "everyMinute"
              }
            ]
          },
          "simple": false,
          "filters": {
            "q": "from: (reservas@rules-shop.es OR reservas@surfin.es OR reservas@snowdivision.es OR info@sierranevadagranada.com)"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.gmailTrigger",
        "typeVersion": 1.3,
        "position": [
          -976,
          480
        ],
        "id": "424c4c3d-50d2-4125-9517-d6184f95d5d8",
        "name": "Correo",
        "credentials": {
          "gmailOAuth2": {
            "id": "fha7KwAzrDSA7OXO",
            "name": "ventas@sierranevadagranada.com"
          }
        }
      },
      {
        "parameters": {
          "content": "INFORME DIARIO DE ALQUILERES\n",
          "height": 896,
          "width": 1104,
          "color": 5
        },
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          -1008,
          80
        ],
        "id": "62875833-b388-4db3-8958-e726c4d976d9",
        "name": "Sticky Note3"
      }
    ],
    "connections": {
      "Webhook": {
        "main": [
          [
            {
              "node": "Get row(s)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "GraphQL": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Copy file": {
        "main": [
          [
            {
              "node": "Update row(s)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Schedule Trigger": {
        "main": [
          [
            {
              "node": "obtener fecha",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code in JavaScript": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 2
            }
          ]
        ]
      },
      "Merge": {
        "main": [
          [
            {
              "node": "Code in JavaScript1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields": {
        "main": [
          [
            {
              "node": "Update row in sheet",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Code in JavaScript1": {
        "main": [
          [
            {
              "node": "Edit Fields",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update row(s)": {
        "main": [
          [
            {
              "node": "Insert row",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get row(s)": {
        "main": [
          [
            {
              "node": "GraphQL",
              "type": "main",
              "index": 0
            },
            {
              "node": "Code in JavaScript",
              "type": "main",
              "index": 0
            },
            {
              "node": "Edit Fields1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Update row in sheet": {
        "main": [
          [
            {
              "node": "Update row(s)1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "GraphQL1": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Edit Fields1": {
        "main": [
          [
            {
              "node": "GraphQL1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "obtener fecha": {
        "main": [
          [
            {
              "node": "formatear fecha",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "formatear fecha": {
        "main": [
          [
            {
              "node": "Copy file",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get row(s)1": {
        "main": [
          [
            {
              "node": "Send a message",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Switch": {
        "main": [
          [
            {
              "node": "rules-shop",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "surfin",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "snowdivision",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "sierranevadagranada",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "rules-shop": {
        "main": [
          [
            {
              "node": "Escribir Rules",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "surfin": {
        "main": [
          [
            {
              "node": "Escribir Surfin",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "snowdivision": {
        "main": [
          [
            {
              "node": "Escribir SnowDivision",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Escribir SnowDivision": {
        "main": [
          [
            {
              "node": "actualizar contador snowdivision",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Escribir Surfin": {
        "main": [
          [
            {
              "node": "actualizar contador surfin",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Escribir Rules": {
        "main": [
          [
            {
              "node": "actualizar contador rules",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "sierranevadagranada": {
        "main": [
          [
            {
              "node": "Escribir sierranevadagranada",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Escribir sierranevadagranada": {
        "main": [
          [
            {
              "node": "actualizar contador sierranevadagranada",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get row(s)2": {
        "main": [
          [
            {
              "node": "Switch",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Correo": {
        "main": [
          [
            {
              "node": "Get row(s)2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "authors": "Info Tailwind",
    "name": "Version 67bdb6dc",
    "description": "",
    "autosaved": false
  },
  "activeVersionId": "67bdb6dc-6e06-4de8-8630-155b38bd686c",
  "connections": {
    "Webhook": {
      "main": [
        [
          {
            "node": "Get row(s)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "GraphQL": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Copy file": {
      "main": [
        [
          {
            "node": "Update row(s)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "obtener fecha",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Code in JavaScript1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Update row in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript1": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row(s)": {
      "main": [
        [
          {
            "node": "Insert row",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s)": {
      "main": [
        [
          {
            "node": "GraphQL",
            "type": "main",
            "index": 0
          },
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet": {
      "main": [
        [
          {
            "node": "Update row(s)1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "GraphQL1": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields1": {
      "main": [
        [
          {
            "node": "GraphQL1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "obtener fecha": {
      "main": [
        [
          {
            "node": "formatear fecha",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "formatear fecha": {
      "main": [
        [
          {
            "node": "Copy file",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s)1": {
      "main": [
        [
          {
            "node": "Send a message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "rules-shop",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "surfin",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "snowdivision",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "sierranevadagranada",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "rules-shop": {
      "main": [
        [
          {
            "node": "Escribir Rules",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "surfin": {
      "main": [
        [
          {
            "node": "Escribir Surfin",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "snowdivision": {
      "main": [
        [
          {
            "node": "Escribir SnowDivision",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Escribir SnowDivision": {
      "main": [
        [
          {
            "node": "actualizar contador snowdivision",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Escribir Surfin": {
      "main": [
        [
          {
            "node": "actualizar contador surfin",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Escribir Rules": {
      "main": [
        [
          {
            "node": "actualizar contador rules",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "sierranevadagranada": {
      "main": [
        [
          {
            "node": "Escribir sierranevadagranada",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Escribir sierranevadagranada": {
      "main": [
        [
          {
            "node": "actualizar contador sierranevadagranada",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s)2": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Correo": {
      "main": [
        [
          {
            "node": "Get row(s)2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2026-01-15T07:50:18.774Z",
  "id": "sQUNg-VuSIFLaMIdA9znD",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "Informe_Diario_Definitivo",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "informeDiario",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        240,
        480
      ],
      "id": "3a169d65-fc08-45f0-a1c1-197ef4d4aa08",
      "name": "Webhook",
      "webhookId": "7c1e3b37-6cc8-4f4a-81e3-c5897bdf497c"
    },
    {
      "parameters": {
        "authentication": "headerAuth",
        "endpoint": "https://rulesshop.myshopify.com/admin/api/2024-07/graphql.json",
        "query": "query getOrder($id: ID!) {\n\n  order(id: $id) {\n\n    id\n\n    name\n\n    createdAt\n\n    email\n\n    totalPriceSet {\n\n      shopMoney {\n\n        amount\n\n        currencyCode\n\n      }\n\n    }\n\n    lineItems(first: 10) {\n\n      edges {\n\n        node {\n\n          title\n\n          quantity\n\n          originalUnitPriceSet {\n\n            shopMoney {\n\n              amount\n\n              currencyCode\n\n            }\n\n          }\n\n        }\n\n      }\n\n    }\n\n    fulfillments {\n\n      id\n\n      location {\n\n        name\n\n        address {\n\n          address1\n\n          city\n\n          province\n\n          country\n\n          zip\n\n        }\n\n      }\n\n    }\n\n    transactions(first: 5) {\n\n      formattedGateway\n\n      kind\n\n      status\n\n    }\n\n    customer {\n\n      firstName\n\n      lastName\n\n      email\n\n    }\n\n  }\n\n}\n",
        "variables": "={\n  \"id\": \"gid://shopify/Order/{{ $('Webhook').item.json.body.id }}\"\n}",
        "headerParametersUi": {
          "parameter": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.graphql",
      "typeVersion": 1.1,
      "position": [
        624,
        480
      ],
      "id": "7255d822-ea0d-446d-83c9-1aee124ad0e8",
      "name": "GraphQL",
      "credentials": {
        "httpHeaderAuth": {
          "id": "OPt2Cl0dnwcU4qRk",
          "name": "ShopifyInformes"
        }
      }
    },
    {
      "parameters": {
        "content": "ENVIAR CORREO",
        "height": 208,
        "width": 384,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        192,
        768
      ],
      "id": "070b8235-6802-470b-bd7a-884c6711458e",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "operation": "copy",
        "fileId": {
          "__rl": true,
          "value": "1QZ-GBz6D6EL4fZh3lh9PyAjwWzyjVn8nN0wy4mUjg04",
          "mode": "id"
        },
        "name": "=Informe_Diario_{{ $json.FECHA }}",
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        656,
        128
      ],
      "id": "67d0cf56-a4b3-432d-9ab3-2b819b9f63a8",
      "name": "Copy file",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "N7JXWgOiVoyCTaVL",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "content": "CREAR DOCUMENTO",
        "height": 208,
        "width": 960,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        192,
        80
      ],
      "id": "2b6bbfe7-3af9-4eb7-a19d-ec2a3322de91",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {}
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.3,
      "position": [
        224,
        128
      ],
      "id": "62e5fa32-0ae7-493b-875f-e37addba632a",
      "name": "Schedule Trigger"
    },
    {
      "parameters": {
        "dataTableId": {
          "__rl": true,
          "value": "8GDVj673ag0hCrVt",
          "mode": "list",
          "cachedResultName": "Informe Mensual",
          "cachedResultUrl": "/projects/x5UZcmGQw2OWHuXb/datatables/8GDVj673ag0hCrVt"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "ID_Documento": "={{ $('Copy file').item.json.id }}",
            "fecha": "={{ $('formatear fecha').item.json.FECHA }}"
          },
          "matchingColumns": [
            "ID_Documento"
          ],
          "schema": [
            {
              "id": "ID_Documento",
              "displayName": "ID_Documento",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "fecha",
              "displayName": "fecha",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.dataTable",
      "typeVersion": 1,
      "position": [
        960,
        128
      ],
      "id": "e5db14bd-7dca-40a9-bee1-b422e5e5f4a0",
      "name": "Insert row"
    },
    {
      "parameters": {
        "jsCode": "// El nodo Code de n8n espera que devolvamos un array de objetos.\nconst outputItems = [];\n\n// Obtenemos el valor del contador del nodo anterior\n// items[0].json.Contador → 2 en tu ejemplo\nlet numeroFila = items[0].json.Contador;\nlet ID_documento = items[0].json.ID_Documento;\n\n// 1. Accedemos al cuerpo real del pedido de Shopify, que está anidado.\nconst orderBody = $node['Webhook'].json.body; \n\n// 2. Extraemos los artículos de línea (productos) y la moneda.\nconst lineItems = orderBody.line_items;\nconst orderCurrency = orderBody.currency;\n\n// Iteramos sobre cada producto individual\nfor (const item of lineItems) {\n\n  const originalPrice = parseFloat(item.price);\n\n  let totalDiscountAmount = 0;\n  for (const allocation of item.discount_allocations) {\n    totalDiscountAmount += parseFloat(allocation.amount);\n  }\n\n  const finalPaidPrice = originalPrice - totalDiscountAmount;\n\n  // Creamos un nuevo objeto y añadimos \"numero_fila\"\n  outputItems.push({\n    json: {\n      ID_documento: ID_documento,\n      numero_fila: numeroFila,   // ← Nuevo campo\n      product_name: item.title,\n      sku: item.sku,\n      variant_title: item.variant_title,\n      original_price: originalPrice.toFixed(2),\n      total_discount_applied: totalDiscountAmount.toFixed(2),\n      final_paid_price: finalPaidPrice.toFixed(2),\n      currency: orderCurrency\n    }\n  });\n\n  // ↑ Incrementamos para el siguiente item\n  numeroFila++;\n}\n\n// Devolvemos el array con los nuevos objetos.\nreturn outputItems;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        624,
        624
      ],
      "id": "f74317cd-37d0-4262-a761-d94cdf479b6a",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "numberInputs": 3
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        864,
        464
      ],
      "id": "5007c6bb-31eb-4b15-be8a-fb06c3e7962e",
      "name": "Merge"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "31828549-6a33-4e8a-91ad-fdb9692a7e34",
              "name": "SUCURSAL DE VENTA",
              "value": "={{ $json.fulfillmentLocation }}",
              "type": "string"
            },
            {
              "id": "e89736ae-2f29-40c8-80b4-2181722ee3f5",
              "name": "METODO DE PAGO",
              "value": "={{ $json.transactionGateway }}",
              "type": "string"
            },
            {
              "id": "dc4a77f5-966d-4efc-b755-1f0fe34f6958",
              "name": "COSTO POR UNIDAD",
              "value": "={{ $json.product.unit_cost }}",
              "type": "string"
            },
            {
              "id": "76140f31-efab-4a68-b737-53f04a9a7b81",
              "name": "COSTE DE PRODUCTO",
              "value": "={{ $json.product.original_price }}",
              "type": "string"
            },
            {
              "id": "d295df2e-e935-41ef-a2b1-7923cabd1a92",
              "name": "PRECIO PAGADO",
              "value": "={{ $json.product.final_paid_price }}",
              "type": "string"
            },
            {
              "id": "adb9ae5a-50d9-4923-b706-31a9a5b86e66",
              "name": "DESCUENTO",
              "value": "={{ $json.product.total_discount_applied }}",
              "type": "string"
            },
            {
              "id": "c2b11c61-81c1-4b6d-94ec-c55b6872e5e0",
              "name": "NOMBRE DE PRODUCTO",
              "value": "={{ $json.product.product_name }}",
              "type": "string"
            },
            {
              "id": "f7cbe128-fbe4-4bfb-b5ec-d7eed2f87b84",
              "name": "VARIANTE",
              "value": "={{ $json.product.variant_title }}",
              "type": "string"
            },
            {
              "id": "1e31a3b3-a073-4113-9047-95110c3d7987",
              "name": "NUMERO_FILA",
              "value": "={{ $json.product.numero_fila }}",
              "type": "number"
            },
            {
              "id": "e4c20adf-aa16-46e1-9851-3844e08241a6",
              "name": "ID_DOCUMENTO",
              "value": "={{ $json.product.ID_documento }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1136,
        480
      ],
      "id": "b52e6336-e7f7-40dd-ad46-c520b057c406",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "jsCode": "// 1. Validaciones básicas\nif (items.length < 2) {\n    throw new Error(\"Se esperaban al menos 2 ítems de entrada.\");\n}\n\n// Inicializamos variables\nlet orderData = null;\nconst productRows = []; // Aquí guardaremos los ítems que tienen ID_documento\nconst costMap = {}; // Aquí guardaremos los costos indexados por SKU\n\n// 2. Clasificar los ítems de entrada\nfor (const item of items) {\n    const json = item.json;\n\n    // A) Es la ORDEN (tiene data.order)\n    if (json.data && json.data.order) {\n        orderData = json.data.order;\n    } \n    // B) Es información de COSTO de Shopify (tiene data.productVariant)\n    else if (json.data && json.data.productVariant) {\n        const variant = json.data.productVariant;\n        const sku = variant.sku;\n        const costAmount = variant.inventoryItem?.unitCost?.amount;\n        \n        // Guardamos el costo en un objeto usando el SKU como clave para buscarlo rápido después\n        if (sku && costAmount) {\n            costMap[sku] = costAmount;\n        }\n    }\n    // C) Es el ítem procesado (tiene ID_documento)\n    else if (json.ID_documento) {\n        productRows.push(json);\n    }\n}\n\nif (!orderData) {\n    throw new Error(\"No se encontró el ítem de la orden de Shopify.\");\n}\n\nif (productRows.length === 0) {\n    throw new Error(\"No se encontraron ítems de producto con ID_documento.\");\n}\n\n// 3. Crear objeto base de la orden\nconst baseOrderData = {\n    id: orderData.id,\n    name: orderData.name,\n    createdAt: orderData.createdAt,\n    totalPrice: orderData.totalPriceSet?.shopMoney?.amount || 'N/A',\n    currencyCode: orderData.totalPriceSet?.shopMoney?.currencyCode || 'N/A',\n    \n    // Datos del cliente\n    customer: orderData.customer,\n    \n    // Datos de envío\n    fulfillmentLocation: orderData.fulfillments?.[0]?.location?.name || 'N/A',\n    fulfillmentAddress: orderData.fulfillments?.[0]?.location?.address || 'N/A',\n    \n    // Datos de la transacción\n    transactionGateway: orderData.transactions?.[0]?.formattedGateway || 'N/A',\n    transactionKind: orderData.transactions?.[0]?.kind || 'N/A',\n    transactionStatus: orderData.transactions?.[0]?.status || 'N/A',\n};\n\n// 4. Iterar sobre los productos y fusionar (incluyendo el costo encontrado)\nconst combinedItems = [];\n\nfor (const productData of productRows) {\n    \n    // Buscamos si existe un costo guardado para este SKU\n    const sku = productData.sku;\n    const unitCost = costMap[sku] || '0.00'; // Si no encuentra match, pone 0.00 o N/A\n\n    const combinedItem = {\n        ...baseOrderData,\n        \n        product: {\n            ID_documento: productData.ID_documento,\n            numero_fila: productData.numero_fila,\n            product_name: productData.product_name,\n            sku: productData.sku,\n            variant_title: productData.variant_title,\n            original_price: productData.original_price,\n            total_discount_applied: productData.total_discount_applied,\n            final_paid_price: productData.final_paid_price,\n            currency: productData.currency,\n            // Aquí agregamos el campo solicitado\n            unit_cost: unitCost \n        }\n    };\n    \n    combinedItems.push({\n        json: combinedItem,\n    });\n}\n\nreturn combinedItems;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        992,
        480
      ],
      "id": "38bbf384-1b40-4d4d-b5cc-97d8454a7303",
      "name": "Code in JavaScript1"
    },
    {
      "parameters": {
        "operation": "update",
        "dataTableId": {
          "__rl": true,
          "value": "ghO8HECzTZgPqOqM",
          "mode": "list",
          "cachedResultName": "InformeDiario",
          "cachedResultUrl": "/projects/x5UZcmGQw2OWHuXb/datatables/ghO8HECzTZgPqOqM"
        },
        "filters": {
          "conditions": [
            {
              "keyValue": "1"
            }
          ]
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "ID_Documento": "={{ $json.id }}",
            "Contador": 2,
            "Contador_Alquiler": 2
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "ID_Documento",
              "displayName": "ID_Documento",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Contador",
              "displayName": "Contador",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Contador_Alquiler",
              "displayName": "Contador_Alquiler",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.dataTable",
      "typeVersion": 1,
      "position": [
        800,
        128
      ],
      "id": "954c39f5-d1ab-48b0-a72f-d98b54032d3b",
      "name": "Update row(s)"
    },
    {
      "parameters": {
        "operation": "get",
        "dataTableId": {
          "__rl": true,
          "value": "ghO8HECzTZgPqOqM",
          "mode": "list",
          "cachedResultName": "InformeDiario",
          "cachedResultUrl": "/projects/x5UZcmGQw2OWHuXb/datatables/ghO8HECzTZgPqOqM"
        },
        "filters": {
          "conditions": [
            {
              "keyValue": "1"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.dataTable",
      "typeVersion": 1,
      "position": [
        416,
        480
      ],
      "id": "4f754bc8-b2f2-4dd8-a946-e584b5dab050",
      "name": "Get row(s)"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "={{ $json.ID_DOCUMENTO}}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Hoja 1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/19bvtVxQK6uMbxP2HZKgGEGM_KWyvJM3vLp1APRSSTEY/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": "={{ $json.NUMERO_FILA }}",
            "SUCURSAL DE VENTA": "={{ $json['SUCURSAL DE VENTA'] }}",
            "MÉTODO DE PAGO": "={{ $json['METODO DE PAGO'] }}",
            "COSTE POR UNIDAD": "={{ $json['COSTO POR UNIDAD'] }}",
            "PRECIO DE PRODUCTO": "={{ $json['COSTE DE PRODUCTO'] }}",
            "PRECIO PAGADO": "={{ $json['PRECIO PAGADO'] }}",
            "DESCUENTO": "={{ $json.DESCUENTO }}",
            "NOMBRE DE PRODUCTO": "={{ $json['NOMBRE DE PRODUCTO'] }}",
            "VARIANTE": "={{ $json.VARIANTE }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "SUCURSAL DE VENTA",
              "displayName": "SUCURSAL DE VENTA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "MÉTODO DE PAGO",
              "displayName": "MÉTODO DE PAGO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "COSTE POR UNIDAD",
              "displayName": "COSTE POR UNIDAD",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "PRECIO DE PRODUCTO",
              "displayName": "PRECIO DE PRODUCTO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "PRECIO PAGADO",
              "displayName": "PRECIO PAGADO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "DESCUENTO",
              "displayName": "DESCUENTO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "NOMBRE DE PRODUCTO",
              "displayName": "NOMBRE DE PRODUCTO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "VARIANTE",
              "displayName": "VARIANTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "SURFIN SIERRA NEVADA",
              "displayName": "SURFIN SIERRA NEVADA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Tarjeta",
              "displayName": "Tarjeta",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Efectivo",
              "displayName": "Efectivo",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Venta Web",
              "displayName": "Venta Web",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "TOTAL",
              "displayName": "TOTAL",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1280,
        480
      ],
      "id": "3456907e-1889-4e9d-87b5-40ea7f7453de",
      "name": "Update row in sheet",
      "executeOnce": false,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "RCuKUCifcA4jENcY",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "dataTableId": {
          "__rl": true,
          "value": "ghO8HECzTZgPqOqM",
          "mode": "list",
          "cachedResultName": "InformeDiario",
          "cachedResultUrl": "/projects/x5UZcmGQw2OWHuXb/datatables/ghO8HECzTZgPqOqM"
        },
        "filters": {
          "conditions": [
            {
              "keyValue": "1"
            }
          ]
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "ID_Documento": "={{ $('Edit Fields').item.json.ID_DOCUMENTO }}",
            "Contador": "={{ $('Edit Fields').item.json.NUMERO_FILA  + 1}}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "ID_Documento",
              "displayName": "ID_Documento",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Contador",
              "displayName": "Contador",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.dataTable",
      "typeVersion": 1,
      "position": [
        1440,
        480
      ],
      "id": "faf01950-eda5-4601-8b6c-75240e769c87",
      "name": "Update row(s)1"
    },
    {
      "parameters": {
        "authentication": "headerAuth",
        "endpoint": "https://rulesshop.myshopify.com/admin/api/2024-07/graphql.json",
        "query": "query getVariantCost($id: ID!) {\n  productVariant(id: $id) {\n    id\n    sku\n    title\n    inventoryItem {\n      id\n      unitCost {\n        amount\n        currencyCode\n      }\n    }\n  }\n}\n\n",
        "variables": "={\n  \"id\": \"{{ $json['ID VARIANTE'] }}\"\n}",
        "headerParametersUi": {
          "parameter": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.graphql",
      "typeVersion": 1.1,
      "position": [
        688,
        336
      ],
      "id": "0547d26f-e2d4-4a83-ad9a-3b3f4097a3c2",
      "name": "GraphQL1",
      "credentials": {
        "httpHeaderAuth": {
          "id": "OPt2Cl0dnwcU4qRk",
          "name": "ShopifyInformes"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "711be730-983a-47e6-99f2-d818a44482be",
              "name": "ID VARIANTE",
              "value": "=gid://shopify/ProductVariant/{{ $('Webhook').item.json.body.line_items[0].variant_id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        576,
        336
      ],
      "id": "296715bd-4cb8-4930-a0d7-966761cc3f3b",
      "name": "Edit Fields1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "87a5aeba-2adf-47d1-8d7b-b55d5016266a",
              "name": "FECHA",
              "value": "={{ $today }}",
              "type": "object"
            }
          ]
        },
        "options": {
          "ignoreConversionErrors": true
        }
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        368,
        128
      ],
      "id": "fccdf808-f4e0-4782-a70b-a6b6e00c2e42",
      "name": "obtener fecha"
    },
    {
      "parameters": {
        "jsCode": "return items.map(item => {\n  const fecha = new Date(item.json.FECHA);\n\n  const dia = String(fecha.getDate()).padStart(2, '0');\n  const mes = String(fecha.getMonth() + 1).padStart(2, '0');\n  const anio = fecha.getFullYear();\n\n  item.json.FECHA = `${dia}/${mes}/${anio}`;\n\n  return item;\n});\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        512,
        128
      ],
      "id": "a2ae42c0-c272-4555-ae7f-445636e14ba8",
      "name": "formatear fecha"
    },
    {
      "parameters": {
        "content": "ACTUALIZAR DOCUMENTO CON CADA PEDIDO",
        "height": 448,
        "width": 1456,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        192,
        304
      ],
      "id": "851e0c70-842c-46c7-a56a-b490e4cc792d",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "sendTo": "emilianomartinezvrd@gmail.com",
        "subject": "Informe diario mamawebaso",
        "message": "=<div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; color: #333333;\">\n  \n  <h2 style=\"color: #2c3e50; border-bottom: 2px solid #007bff; padding-bottom: 10px;\">\n    INFORME DIARIO ({{ $now.toFormat('dd/MM/yyyy') }})\n  </h2>\n\n  <p>Hola,</p>\n  \n  <p>Aquí tienes el informe actualizado correspondiente al día de hoy.</p>\n  <p>Puedes acceder al archivo o recurso haciendo clic en el siguiente botón:</p>\n\n  <div style=\"margin: 30px 0;\">\n    <a href=\"https://docs.google.com/spreadsheets/d/{{ $json.ID_Documento }}/edit?gid=0#gid=0\" \n       style=\"background-color: #007bff; color: #ffffff; padding: 12px 24px; text-decoration: none; border-radius: 5px; font-weight: bold; display: inline-block;\">\n       VER DOCUMENTO\n    </a>\n  </div>\n\n  <p style=\"font-size: 12px; color: #888;\">\n    Este es un mensaje automático enviado por tu flujo de n8n.\n  </p>\n  \n</div>",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.2,
      "position": [
        384,
        816
      ],
      "id": "e0a1443f-7789-45c3-88a0-4471df57e63a",
      "name": "Send a message",
      "webhookId": "395b376a-113e-4e7e-b92d-4afaa0028904",
      "credentials": {
        "gmailOAuth2": {
          "id": "wR7U82S8bmDH4odC",
          "name": "info@tailwind.es"
        }
      }
    },
    {
      "parameters": {
        "operation": "get",
        "dataTableId": {
          "__rl": true,
          "value": "ghO8HECzTZgPqOqM",
          "mode": "list",
          "cachedResultName": "InformeDiario",
          "cachedResultUrl": "/projects/x5UZcmGQw2OWHuXb/datatables/ghO8HECzTZgPqOqM"
        },
        "filters": {
          "conditions": [
            {
              "keyValue": "1"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.dataTable",
      "typeVersion": 1.1,
      "position": [
        224,
        816
      ],
      "id": "6762e93d-c33c-4008-9d9c-7fd70d47fbf5",
      "name": "Get row(s)1"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Correo').item.json.from.text }}",
                    "rightValue": "=reservas@rules-shop.es",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "5702ef6b-4e43-4933-9af3-abf329de5e06"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "1384d8f9-c75c-4be1-a293-98c0d102292b",
                    "leftValue": "={{ $('Correo').item.json.from.text }}",
                    "rightValue": "reservas@surfin.es",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "fe1d90fc-f649-48e8-9f37-c58ef22f10c7",
                    "leftValue": "={{ $('Correo').item.json.from.text }}",
                    "rightValue": "reservas@snowdivision.es",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "06d5176e-59be-4584-9efb-c8a5f233789c",
                    "leftValue": "={{ $('Correo').item.json.from.value[0].address }}",
                    "rightValue": "info@sierranevadagranada.com",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        -656,
        448
      ],
      "id": "fa3ccb4f-aef5-4d7b-a691-90267f5171fe",
      "name": "Switch"
    },
    {
      "parameters": {
        "jsCode": "// 1. Accedemos a los datos del email original\nconst correoOriginal = $('Correo').item.json;\nconst subject = (correoOriginal.subject || \"\").replace(/\\n/g, ' ').trim();\nconst bodyText = correoOriginal.text || \"\";\n\n// 2. Accedemos al contador base\nconst datosPrevios = $input.first().json;\nconst contadorBase = parseInt(datosPrevios.Contador_Alquiler) || 0;\n\n// 3. Identificar Marca\nlet marca = \"Rules\";\nif (subject.toLowerCase().includes(\"surfin\")) marca = \"Surfin\";\nif (subject.toLowerCase().includes(\"snow division\")) marca = \"Snow Division\";\n\n// 4. Extraer Datos del Cliente\nlet nombreCompleto = \"No encontrado\";\nconst partesAsunto = subject.split(\" - \");\nif (partesAsunto.length >= 3) {\n    nombreCompleto = partesAsunto[2].trim();\n}\nconst nombrePartes = nombreCompleto.split(\" \");\nconst nombre = nombrePartes[0].replace(/\\n/g, '').trim();\nconst apellidos = nombrePartes.slice(1).join(\" \").replace(/\\n/g, '').trim();\nconst clienteEmail = (correoOriginal.to.value[0].address || \"No encontrado\").replace(/\\n/g, '').trim();\n\n// 5. Totales e Identificador\nconst totalMatch = bodyText.match(/TOTAL:\\s*([\\d,.]+)/);\nconst precioTotal = totalMatch ? totalMatch[1].replace(/\\n/g, '').trim() : \"0.00\";\nconst orderMatch = bodyText.match(/Identificador:\\s*\\n*([A-Z0-9]+)/);\nconst idPedido = orderMatch ? orderMatch[1].replace(/\\n/g, '').trim() : \"No encontrado\";\n\n// 6. Canal y Método de Pago\nconst canalMatch = bodyText.match(/Canal:\\s*\\n*([^\\n]+)/);\nconst canalVenta = canalMatch ? canalMatch[1].replace(/\\n/g, ' ').trim() : \"Desconocido\";\nconst pagoMatch = bodyText.match(/Acción requerida\\s+[\\d,.]+€\\s+[\\d/]+\\s+([^\\n\\t]+)\\s+Efectuado/i);\nconst metodoPago = pagoMatch ? pagoMatch[1].replace(/\\n/g, ' ').trim() : \"No encontrado\";\n\n// 7. Extraer y AGRUPAR Productos\nconst productosMap = {};\nconst productRegex = /([A-Z0-9\\sÁÉÍÓÚÑ\\-]{5,})\\n\\n(\\d+)\\s+([\\d,.]+)€/g;\nlet match;\n\nwhile ((match = productRegex.exec(bodyText)) !== null) {\n    // LIMPIEZA: Quitamos saltos de línea del nombre del producto\n    let nombreProd = match[1].replace(/\\n/g, ' ').replace(/\\s+/g, ' ').trim();\n    \n    if (nombreProd.includes(\"2X1\")) nombreProd = \"EQUIPO ESQUÍ 2X1\";\n    const cantidad = parseInt(match[2]);\n    const precioUnitario = match[3].replace(',', '.').replace(/\\n/g, '').trim();\n\n    if (productosMap[nombreProd]) {\n        productosMap[nombreProd].cantidad += cantidad;\n    } else {\n        productosMap[nombreProd] = { nombre: nombreProd, cantidad, precio_unitario: precioUnitario };\n    }\n}\n\n// 8. Generar salida plana\nconst productosArray = Object.values(productosMap);\n// LIMPIEZA: El resumen también sin saltos de línea\nconst resumenTexto = productosArray.map(p => `${p.nombre} x${p.cantidad}`).join(', ').replace(/\\n/g, ' ');\n\nreturn productosArray.map((prod, index) => {\n    const numeroFilaActual = contadorBase + index;\n\n    if (index === 0) {\n        return {\n            \"numero_fila\": numeroFilaActual,\n            \"marca\": marca,\n            \"cliente_nombre\": nombre,\n            \"cliente_apellidos\": apellidos,\n            \"cliente_email\": clienteEmail,\n            \"id_pedido\": idPedido,\n            \"canal\": canalVenta,\n            \"metodo_pago\": metodoPago,\n            \"total_compra\": precioTotal,\n            \"nombre_producto\": prod.nombre, // Ya limpio arriba\n            \"cantidad\": prod.cantidad,\n            \"precio_unitario\": prod.precio_unitario,\n            \"productos_resumen\": resumenTexto\n        };\n    } else {\n        return {\n            \"numero_fila\": numeroFilaActual,\n            \"marca\": \"\",\n            \"cliente_nombre\": \"\",\n            \"cliente_apellidos\": \"\",\n            \"cliente_email\": \"\",\n            \"id_pedido\": \"\",\n            \"canal\": \"\",\n            \"metodo_pago\": \"\",\n            \"total_compra\": \"\",\n            \"nombre_producto\": prod.nombre,\n            \"cantidad\": prod.cantidad,\n            \"precio_unitario\": prod.precio_unitario,\n            \"productos_resumen\": \"\"\n        };\n    }\n});"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -464,
        256
      ],
      "id": "132c4e3b-b445-4f4b-bdff-7374f9e5ff18",
      "name": "rules-shop"
    },
    {
      "parameters": {
        "jsCode": "// 1. Accedemos a los datos del email original\nconst correoOriginal = $('Correo').item.json;\nconst subject = (correoOriginal.subject || \"\").replace(/\\n/g, ' ').trim();\nconst bodyText = correoOriginal.text || \"\";\n\n// 2. Accedemos al contador del nodo anterior\nconst datosPrevios = $input.first().json;\nconst contadorBase = parseInt(datosPrevios.Contador_Alquiler) || 0;\n\n// 3. Extraer Marca\nconst marca = subject.includes(\"Surfin\") ? \"Surfin\" : (subject.includes(\"Snow Division\") ? \"Snow Division\" : \"Rules\");\n\n// 4. Extraer Datos del Cliente\nlet nombreCompleto = \"No indicado\";\nconst partesAsunto = subject.split(\" - \");\nif (partesAsunto.length >= 3 && partesAsunto[2].trim() !== \"\") {\n    nombreCompleto = partesAsunto[2].trim();\n}\n\nconst nombrePartes = nombreCompleto.split(\" \");\nconst nombre = (nombrePartes[0] || \"No indicado\").replace(/\\n/g, '').trim();\nconst apellidos = nombrePartes.slice(1).join(\" \").replace(/\\n/g, '').trim();\n\nconst clienteEmail = (correoOriginal.to?.value?.[0]?.address || correoOriginal.from?.value?.[0]?.address || \"No encontrado\").replace(/\\n/g, '').trim();\n\n// 5. Totales e Identificador\nconst totalMatch = bodyText.match(/TOTAL:\\s*([\\d,.]+)/);\nconst precioTotal = totalMatch ? totalMatch[1].replace(/\\n/g, '').trim() : \"0.00\";\nconst orderMatch = bodyText.match(/Identificador:\\s*\\n*([A-Z0-9]+)/);\nconst idPedido = orderMatch ? orderMatch[1].replace(/\\n/g, '').trim() : \"No encontrado\";\n\n// 6. Canal y Método de Pago\nconst canalMatch = bodyText.match(/Canal:\\s*\\n*([^\\n]+)/);\nconst canalVenta = canalMatch ? canalMatch[1].replace(/\\n/g, ' ').trim() : \"Desconocido\";\n\nconst pagoMatch = bodyText.match(/Acción requerida\\s+[\\d,.]+€\\s+[\\d/]+\\s+([^\\n\\t]+)\\s+Efectuado/i);\nconst metodoPago = pagoMatch ? pagoMatch[1].replace(/\\n/g, ' ').trim() : \"No encontrado\";\n\n// 7. Extraer y AGRUPAR Productos\nconst productosMap = {};\nconst productRegex = /PRODUCTO\\n\\n(\\d+)\\s+([\\d,.]+)€\\n\\nLocalizador:\\s*([a-z0-9]+)\\nConcepto:\\s*([^\\n]+)/gi;\nlet match;\n\nwhile ((match = productRegex.exec(bodyText)) !== null) {\n    // LIMPIEZA: Quitamos saltos de línea y normalizamos espacios\n    let nombreProd = match[4].replace(/\\n/g, ' ').replace(/\\s+/g, ' ').trim().toUpperCase();\n    const cantidad = parseInt(match[1]);\n    const precioUnitario = match[2].replace(',', '.').replace(/\\n/g, '').trim();\n\n    if (productosMap[nombreProd]) {\n        productosMap[nombreProd].cantidad += cantidad;\n    } else {\n        productosMap[nombreProd] = { nombre: nombreProd, cantidad, precio_unitario: precioUnitario };\n    }\n}\n\n// 8. Fallback si el anterior no captura nada\nif (Object.keys(productosMap).length === 0) {\n    const fallbackRegex = /([A-Z0-9\\sÁÉÍÓÚÑ\\-]{5,})\\n\\n(\\d+)\\s+([\\d,.]+)€/g;\n    let fallbackMatch;\n    while ((fallbackMatch = fallbackRegex.exec(bodyText)) !== null) {\n        // LIMPIEZA: También en el fallback\n        let nProd = fallbackMatch[1].replace(/\\n/g, ' ').replace(/\\s+/g, ' ').trim();\n        if (nProd.includes(\"2X1\")) nProd = \"EQUIPO ESQUÍ 2X1\";\n        const cant = parseInt(fallbackMatch[2]);\n        const prec = fallbackMatch[3].replace(',', '.').replace(/\\n/g, '').trim();\n        if (productosMap[nProd]) productosMap[nProd].cantidad += cant;\n        else productosMap[nProd] = { nombre: nProd, cantidad: cant, precio_unitario: prec };\n    }\n}\n\n// 9. CREAR SALIDA DIFERENCIADA\nconst productosArray = Object.values(productosMap);\nconst resumenTexto = productosArray.map(p => `${p.nombre} x${p.cantidad}`).join(', ').replace(/\\n/g, ' ');\n\nif (productosArray.length === 0) {\n    productosArray.push({ nombre: \"PRODUCTO NO DETECTADO\", cantidad: 1, precio_unitario: \"0.00\" });\n}\n\nreturn productosArray.map((prod, index) => {\n    const numeroFilaActual = contadorBase + index;\n\n    if (index === 0) {\n        return {\n            \"numero_fila\": numeroFilaActual,\n            \"MARCA\": marca,\n            \"NOMBRE CLIENTE\": nombre,\n            \"APELLIDOS\": apellidos,\n            \"ID PEDIDO\": idPedido,\n            \"EMAIL\": clienteEmail,\n            \"CANAL\": canalVenta,\n            \"MÉTODO DE PAGO\": metodoPago,\n            \"TOTAL COMPRA (+IVA)\": precioTotal,\n            \"NOMBRE PRODUCTO\": prod.nombre,\n            \"CANTIDAD\": prod.cantidad,\n            \"PRECIO UNITARIO\": prod.precio_unitario,\n            \"RESUMEN\": resumenTexto\n        };\n    } else {\n        return {\n            \"numero_fila\": numeroFilaActual,\n            \"MARCA\": \"\", \n            \"NOMBRE CLIENTE\": \"\",\n            \"APELLIDOS\": \"\",\n            \"ID PEDIDO\": \"\",\n            \"EMAIL\": \"\",\n            \"CANAL\": \"\",\n            \"MÉTODO DE PAGO\": \"\",\n            \"TOTAL COMPRA (+IVA)\": \"\",\n            \"NOMBRE PRODUCTO\": prod.nombre,\n            \"CANTIDAD\": prod.cantidad,\n            \"PRECIO UNITARIO\": prod.precio_unitario,\n            \"RESUMEN\": \"\"\n        };\n    }\n});"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -464,
        400
      ],
      "id": "d58a6580-401b-4d55-bc2f-a2bcb34c3ee5",
      "name": "surfin"
    },
    {
      "parameters": {
        "jsCode": "// 1. Accedemos a los datos del email original\nconst correoOriginal = $('Correo').item.json;\nconst subject = (correoOriginal.subject || \"\").replace(/\\n/g, ' ').trim();\nconst bodyText = correoOriginal.text || \"\";\n\n// 2. Accedemos al contador base del nodo anterior\nconst datosPrevios = $input.first().json;\nconst contadorBase = parseInt(datosPrevios.Contador_Alquiler) || 0; \n\n// 3. Identificar Marca\nlet marca = \"Rules\";\nif (subject.toLowerCase().includes(\"surfin\")) marca = \"Surfin\";\nif (subject.toLowerCase().includes(\"snow division\")) marca = \"Snow Division\";\n\n// 4. Extraer Datos del Cliente\nlet nombreCompleto = \"No encontrado\";\nconst partesAsunto = subject.split(\" - \");\nif (partesAsunto.length >= 3) {\n    nombreCompleto = partesAsunto[2].trim();\n}\nconst nombrePartes = nombreCompleto.split(\" \");\nconst nombre = (nombrePartes[0] || \"\").replace(/\\n/g, '').trim();\nconst apellidos = nombrePartes.slice(1).join(\" \").replace(/\\n/g, '').trim();\nconst clienteEmail = (correoOriginal.to.value[0].address || \"No encontrado\").replace(/\\n/g, '').trim();\n\n// 5. Totales e Identificador\nconst totalMatch = bodyText.match(/TOTAL:\\s*([\\d,.]+)/);\nconst precioTotal = totalMatch ? totalMatch[1].replace(/\\n/g, '').trim() : \"0.00\";\nconst orderMatch = bodyText.match(/Identificador:\\s*\\n*([A-Z0-9]+)/);\nconst idPedido = orderMatch ? orderMatch[1].replace(/\\n/g, '').trim() : \"No encontrado\";\n\n// 6. Canal y Método de Pago\nconst canalMatch = bodyText.match(/Canal:\\s*\\n*([^\\n]+)/);\nconst canalVenta = canalMatch ? canalMatch[1].replace(/\\n/g, ' ').trim() : \"Desconocido\";\nconst pagoMatch = bodyText.match(/Acción requerida\\s+[\\d,.]+€\\s+[\\d/]+\\s+([^\\n\\t]+)\\s+Efectuado/i);\nconst metodoPago = pagoMatch ? pagoMatch[1].replace(/\\n/g, ' ').trim() : \"No encontrado\";\n\n// 7. Extraer y AGRUPAR Productos\nconst productosMap = {};\nconst productRegex = /([A-Z0-9\\sÁÉÍÓÚÑ\\-]{5,})\\n\\n(\\d+)\\s+([\\d,.]+)€/g;\nlet match;\n\nwhile ((match = productRegex.exec(bodyText)) !== null) {\n    // LIMPIEZA: Eliminamos saltos de línea y colapsamos espacios múltiples en el nombre del producto\n    let nombreProd = match[1].replace(/\\n/g, ' ').replace(/\\s+/g, ' ').trim();\n    \n    if (nombreProd.includes(\"2X1\")) nombreProd = \"EQUIPO ESQUÍ 2X1\";\n    const cantidad = parseInt(match[2]);\n    const precioUnitario = match[3].replace(',', '.').replace(/\\n/g, '').trim();\n\n    if (productosMap[nombreProd]) {\n        productosMap[nombreProd].cantidad += cantidad;\n    } else {\n        productosMap[nombreProd] = { nombre: nombreProd, cantidad, precio_unitario: precioUnitario };\n    }\n}\n\n// 8. Generar salida plana para Google Sheets\nconst productosArray = Object.values(productosMap);\n// LIMPIEZA: Resumen sin saltos de línea para que no rompa la celda\nconst resumenTexto = productosArray.map(p => `${p.nombre} x${p.cantidad}`).join(', ').replace(/\\n/g, ' ');\n\nreturn productosArray.map((prod, index) => {\n    const numeroFilaActual = contadorBase + index;\n\n    if (index === 0) {\n        return {\n            \"numero_fila\": numeroFilaActual,\n            \"marca\": marca,\n            \"cliente_nombre\": nombre,\n            \"cliente_apellidos\": apellidos,\n            \"cliente_email\": clienteEmail,\n            \"id_pedido\": idPedido,\n            \"canal\": canalVenta,\n            \"metodo_pago\": metodoPago,\n            \"total_compra\": precioTotal,\n            \"nombre_producto\": prod.nombre,\n            \"cantidad\": prod.cantidad,\n            \"precio_unitario\": prod.precio_unitario,\n            \"productos_resumen\": resumenTexto\n        };\n    } else {\n        return {\n            \"numero_fila\": numeroFilaActual,\n            \"marca\": \"\",\n            \"cliente_nombre\": \"\",\n            \"cliente_apellidos\": \"\",\n            \"cliente_email\": \"\",\n            \"id_pedido\": \"\",\n            \"canal\": \"\",\n            \"metodo_pago\": \"\",\n            \"total_compra\": \"\",\n            \"nombre_producto\": prod.nombre,\n            \"cantidad\": prod.cantidad,\n            \"precio_unitario\": prod.precio_unitario,\n            \"productos_resumen\": \"\"\n        };\n    }\n});"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -464,
        544
      ],
      "id": "9031743d-79e1-4b7d-a852-e3aa8b68164a",
      "name": "snowdivision"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "={{ $('Get row(s)2').item.json.ID_Documento }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "Alquiler",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "MARCA": "={{ $json.marca }}",
            "NOMBRE CLIENTE": "={{ $json.cliente_nombre }}",
            "APELLIDOS CLIENTE": "={{ $json.cliente_apellidos }}",
            "EMAIL": "={{ $json.cliente_email }}",
            "ID PEDIDO": "={{ $json.id_pedido }}",
            "CANAL": "={{ $json.canal }}",
            "MÉTODO DE PAGO": "={{ $json.metodo_pago }}",
            "TOTAL COMPRA (+IVA)": "={{ $json.total_compra }}",
            "NOMBRE PRODUCTO": "={{ $json.nombre_producto }}",
            "CANTIDAD": "={{ $json.cantidad }}",
            "PRECIO UNITARIO": "={{ $json.precio_unitario }}",
            "RESUMEN": "={{ $json.productos_resumen }}",
            "row_number": "={{ $json.numero_fila }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "MARCA",
              "displayName": "MARCA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "NOMBRE CLIENTE",
              "displayName": "NOMBRE CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "APELLIDOS CLIENTE",
              "displayName": "APELLIDOS CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "EMAIL",
              "displayName": "EMAIL",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "ID PEDIDO",
              "displayName": "ID PEDIDO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "CANAL",
              "displayName": "CANAL",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "MÉTODO DE PAGO",
              "displayName": "MÉTODO DE PAGO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "TOTAL COMPRA (+IVA)",
              "displayName": "TOTAL COMPRA (+IVA)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "NOMBRE PRODUCTO",
              "displayName": "NOMBRE PRODUCTO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "CANTIDAD",
              "displayName": "CANTIDAD",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "PRECIO UNITARIO",
              "displayName": "PRECIO UNITARIO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "RESUMEN",
              "displayName": "RESUMEN",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -288,
        544
      ],
      "id": "7367a66d-8df9-476b-8c0b-5479607fb339",
      "name": "Escribir SnowDivision",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "RCuKUCifcA4jENcY",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "={{ $('Get row(s)2').item.json.ID_Documento }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "Alquiler",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "MARCA": "={{ $json.marca }}",
            "row_number": "={{ $json.numero_fila }}",
            "NOMBRE CLIENTE": "={{ $json.nombre_cliente }}",
            "APELLIDOS CLIENTE": "={{ $json.cliente_apellidos }}",
            "EMAIL": "={{ $json.cliente_email }}",
            "ID PEDIDO": "={{ $json.id_pedido }}",
            "CANAL": "={{ $json.canal }}",
            "MÉTODO DE PAGO": "={{ $json.metodo_pago }}",
            "TOTAL COMPRA (+IVA)": "={{ $json.total_compra }}",
            "NOMBRE PRODUCTO": "={{ $json.nombre_producto }}",
            "CANTIDAD": "={{ $json.cantidad }}",
            "PRECIO UNITARIO": "={{ $json.precio_unitario }}",
            "RESUMEN": "={{ $json.productos_resumen }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "MARCA",
              "displayName": "MARCA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "NOMBRE CLIENTE",
              "displayName": "NOMBRE CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "APELLIDOS CLIENTE",
              "displayName": "APELLIDOS CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "EMAIL",
              "displayName": "EMAIL",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "ID PEDIDO",
              "displayName": "ID PEDIDO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "CANAL",
              "displayName": "CANAL",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "MÉTODO DE PAGO",
              "displayName": "MÉTODO DE PAGO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "TOTAL COMPRA (+IVA)",
              "displayName": "TOTAL COMPRA (+IVA)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "NOMBRE PRODUCTO",
              "displayName": "NOMBRE PRODUCTO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "CANTIDAD",
              "displayName": "CANTIDAD",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "PRECIO UNITARIO",
              "displayName": "PRECIO UNITARIO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "RESUMEN",
              "displayName": "RESUMEN",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -288,
        400
      ],
      "id": "e4cb0885-b4e6-46e5-abc8-ced7e117233d",
      "name": "Escribir Surfin",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "RCuKUCifcA4jENcY",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "={{ $('Get row(s)2').item.json.ID_Documento }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "Alquiler",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": "={{ $json.numero_fila }}",
            "MARCA": "={{ $json.marca }}",
            "NOMBRE CLIENTE": "={{ $json.cliente_nombre }}",
            "APELLIDOS CLIENTE": "={{ $json.cliente_apellidos }}",
            "EMAIL": "={{ $json.cliente_email }}",
            "ID PEDIDO": "={{ $json.id_pedido }}",
            "CANAL": "={{ $json.canal }}",
            "MÉTODO DE PAGO": "={{ $json.metodo_pago }}",
            "TOTAL COMPRA (+IVA)": "={{ $json.total_compra }}",
            "NOMBRE PRODUCTO": "={{ $json.nombre_producto }}",
            "CANTIDAD": "={{ $json.cantidad }}",
            "PRECIO UNITARIO": "={{ $json.precio_unitario }}",
            "RESUMEN": "={{ $json.productos_resumen }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "MARCA",
              "displayName": "MARCA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "NOMBRE CLIENTE",
              "displayName": "NOMBRE CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "APELLIDOS CLIENTE",
              "displayName": "APELLIDOS CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "EMAIL",
              "displayName": "EMAIL",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "ID PEDIDO",
              "displayName": "ID PEDIDO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "CANAL",
              "displayName": "CANAL",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "MÉTODO DE PAGO",
              "displayName": "MÉTODO DE PAGO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "TOTAL COMPRA (+IVA)",
              "displayName": "TOTAL COMPRA (+IVA)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "NOMBRE PRODUCTO",
              "displayName": "NOMBRE PRODUCTO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "CANTIDAD",
              "displayName": "CANTIDAD",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "PRECIO UNITARIO",
              "displayName": "PRECIO UNITARIO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "RESUMEN",
              "displayName": "RESUMEN",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -288,
        256
      ],
      "id": "9262d50b-9185-4607-81c6-ad91edd89465",
      "name": "Escribir Rules",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "RCuKUCifcA4jENcY",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "dataTableId": {
          "__rl": true,
          "value": "ghO8HECzTZgPqOqM",
          "mode": "list",
          "cachedResultName": "InformeDiario",
          "cachedResultUrl": "/projects/x5UZcmGQw2OWHuXb/datatables/ghO8HECzTZgPqOqM"
        },
        "filters": {
          "conditions": [
            {
              "keyValue": "1"
            }
          ]
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Contador_Alquiler": "={{ $json.row_number + 1}}",
            "Contador": "={{ $('Get row(s)2').item.json.Contador }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "ID_Documento",
              "displayName": "ID_Documento",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Contador",
              "displayName": "Contador",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Contador_Alquiler",
              "displayName": "Contador_Alquiler",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.dataTable",
      "typeVersion": 1.1,
      "position": [
        -128,
        256
      ],
      "id": "520dc12b-583c-40bd-80d8-b54401ade2f1",
      "name": "actualizar contador rules"
    },
    {
      "parameters": {
        "operation": "update",
        "dataTableId": {
          "__rl": true,
          "value": "ghO8HECzTZgPqOqM",
          "mode": "list",
          "cachedResultName": "InformeDiario",
          "cachedResultUrl": "/projects/x5UZcmGQw2OWHuXb/datatables/ghO8HECzTZgPqOqM"
        },
        "filters": {
          "conditions": [
            {
              "keyValue": "1"
            }
          ]
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Contador_Alquiler": "={{ $json.row_number + 1}}",
            "Contador": "={{ $('Get row(s)2').item.json.Contador }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "ID_Documento",
              "displayName": "ID_Documento",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Contador",
              "displayName": "Contador",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Contador_Alquiler",
              "displayName": "Contador_Alquiler",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.dataTable",
      "typeVersion": 1.1,
      "position": [
        -128,
        400
      ],
      "id": "6b0db584-2a39-46bb-902d-9131fa4ce1e0",
      "name": "actualizar contador surfin"
    },
    {
      "parameters": {
        "operation": "update",
        "dataTableId": {
          "__rl": true,
          "value": "ghO8HECzTZgPqOqM",
          "mode": "list",
          "cachedResultName": "InformeDiario",
          "cachedResultUrl": "/projects/x5UZcmGQw2OWHuXb/datatables/ghO8HECzTZgPqOqM"
        },
        "filters": {
          "conditions": [
            {
              "keyValue": "1"
            }
          ]
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Contador_Alquiler": "={{ $json.row_number + 1}}",
            "Contador": "={{ $('Get row(s)2').item.json.Contador }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "ID_Documento",
              "displayName": "ID_Documento",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Contador",
              "displayName": "Contador",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Contador_Alquiler",
              "displayName": "Contador_Alquiler",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "dryRun": false
        }
      },
      "type": "n8n-nodes-base.dataTable",
      "typeVersion": 1.1,
      "position": [
        -128,
        544
      ],
      "id": "56f1f664-3f3e-480a-84a8-f9067fb0d648",
      "name": "actualizar contador snowdivision"
    },
    {
      "parameters": {
        "jsCode": "// 1. Accedemos a los datos del email original del nodo \"Correo\"\nconst correoOriginal = $('Correo').item.json;\nconst subject = (correoOriginal.subject || \"\").replace(/\\n/g, ' ').trim();\nconst bodyText = correoOriginal.text || \"\";\n\n// 2. Accedemos al contador base del nodo anterior ($input)\nconst datosPrevios = $input.first().json;\nconst contadorBase = parseInt(datosPrevios.Contador_Alquiler) || 0;\n\n// 3. Extraer Marca (Sierra Nevada Granada)\nlet marca = \"Sierra Nevada Granada\";\n\n// 4. Extraer Datos del Cliente del Subject\nlet nombreCompleto = \"No encontrado\";\nconst partesAsunto = subject.split(\" - \");\nif (partesAsunto.length >= 2) {\n    nombreCompleto = partesAsunto[1].trim();\n}\nconst nombrePartes = nombreCompleto.split(\" \");\nconst nombre = (nombrePartes[0] || \"\").replace(/\\n/g, '').trim();\nconst apellidos = nombrePartes.slice(1).join(\" \").replace(/\\n/g, '').trim();\nconst clienteEmail = (correoOriginal.from?.value?.[0]?.address || \"No encontrado\").replace(/\\n/g, '').trim();\n\n// 5. Identificador del Pedido (Número: SO...)\nconst orderMatch = bodyText.match(/N[úu]mero:\\s*(SO\\d+)/i);\nconst idPedido = orderMatch ? orderMatch[1].replace(/\\n/g, '').trim() : \"No encontrado\";\n\n// 6. Canal de Venta\nconst canalVenta = partesAsunto[2] ? partesAsunto[2].replace(\"canal \", \"\").replace(/\\n/g, ' ').trim() : \"Reservas\";\n\n// 7. Extraer y AGRUPAR Productos\nconst productosMap = {};\n\n/** * Regex para el formato Sierra Nevada: Limpia saltos de línea dentro del nombre\n */\nconst productRegex = /Descripci[óo]n\\s+Cant\\.\\s+([\\w\\sÁÉÍÓÚÑ\\-]+?)\\s+(\\d+[\\d,.]*)/g;\nlet match;\n\nwhile ((match = productRegex.exec(bodyText)) !== null) {\n    // LIMPIEZA: Quitamos saltos de línea y espacios múltiples del nombre del producto\n    let nombreProd = match[1].replace(/\\n/g, ' ').replace(/\\s+/g, ' ').trim();\n    nombreProd = nombreProd.split('  ')[0].trim(); // Evita capturar cabeceras si se filtran\n    \n    const cantidad = parseInt(match[2].split(',')[0]);\n\n    if (productosMap[nombreProd]) {\n        productosMap[nombreProd].cantidad += cantidad;\n    } else {\n        productosMap[nombreProd] = { \n            nombre: nombreProd, \n            cantidad: cantidad, \n            precio_unitario: \"Ver email\" \n        };\n    }\n}\n\n// 8. Búsqueda de emergencia para Forfaits (limpia también)\nif (Object.keys(productosMap).length === 0) {\n    const forfaitMatch = bodyText.match(/Forfait\\s+D[íi]as\\s+Consecutivos/i);\n    if (forfaitMatch) {\n        productosMap[\"FORFAIT DÍAS CONSECUTIVOS\"] = { nombre: \"FORFAIT DÍAS CONSECUTIVOS\", cantidad: 1, precio_unitario: \"Ver email\" };\n    }\n}\n\n// 9. Generar salida para Google Sheets\nconst productosArray = Object.values(productosMap);\n// Resumen unificado en una sola línea\nconst resumenTexto = productosArray.map(p => `${p.nombre} x${p.cantidad}`).join(', ').replace(/\\n/g, ' ');\n\nif (productosArray.length === 0) {\n    productosArray.push({ nombre: \"PRODUCTO NO DETECTADO\", cantidad: 1, precio_unitario: \"Ver email\" });\n}\n\nreturn productosArray.map((prod, index) => {\n    const numeroFilaActual = contadorBase + index;\n\n    if (index === 0) {\n        return {\n            \"numero_fila\": numeroFilaActual,\n            \"marca\": marca,\n            \"cliente_nombre\": nombre,\n            \"cliente_apellidos\": apellidos,\n            \"cliente_email\": clienteEmail,\n            \"id_pedido\": idPedido,\n            \"canal\": canalVenta,\n            \"metodo_pago\": \"Tarjeta\",\n            \"total_compra\": \"Ver justificante\",\n            \"nombre_producto\": prod.nombre,\n            \"cantidad\": prod.cantidad,\n            \"precio_unitario\": prod.precio_unitario,\n            \"productos_resumen\": resumenTexto\n        };\n    } else {\n        return {\n            \"numero_fila\": numeroFilaActual,\n            \"marca\": \"\",\n            \"cliente_nombre\": \"\",\n            \"cliente_apellidos\": \"\",\n            \"cliente_email\": \"\",\n            \"id_pedido\": \"\",\n            \"canal\": \"\",\n            \"metodo_pago\": \"\",\n            \"total_compra\": \"\",\n            \"nombre_producto\": prod.nombre,\n            \"cantidad\": prod.cantidad,\n            \"precio_unitario\": prod.precio_unitario,\n            \"productos_resumen\": \"\"\n        };\n    }\n});"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -464,
        688
      ],
      "id": "639143ee-f6eb-4832-af8e-48d41053a656",
      "name": "sierranevadagranada"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "={{ $('Get row(s)2').item.json.ID_Documento }}",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "Alquiler",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": "={{ $json.numero_fila }}",
            "MARCA": "={{ $json.marca }}",
            "NOMBRE CLIENTE": "={{ $json.cliente_nombre }}",
            "APELLIDOS CLIENTE": "={{ $json.cliente_apellidos }}",
            "EMAIL": "={{ $json.cliente_email }}",
            "ID PEDIDO": "={{ $json.id_pedido }}",
            "CANAL": "={{ $json.canal }}",
            "MÉTODO DE PAGO": "={{ $json.metodo_pago }}",
            "TOTAL COMPRA (+IVA)": "={{ $json.total_compra }}",
            "NOMBRE PRODUCTO": "={{ $json.nombre_producto }}",
            "CANTIDAD": "={{ $json.cantidad }}",
            "PRECIO UNITARIO": "={{ $json.precio_unitario }}",
            "RESUMEN": "={{ $json.productos_resumen }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "MARCA",
              "displayName": "MARCA",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "NOMBRE CLIENTE",
              "displayName": "NOMBRE CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "APELLIDOS CLIENTE",
              "displayName": "APELLIDOS CLIENTE",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "EMAIL",
              "displayName": "EMAIL",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "ID PEDIDO",
              "displayName": "ID PEDIDO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "CANAL",
              "displayName": "CANAL",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "MÉTODO DE PAGO",
              "displayName": "MÉTODO DE PAGO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "TOTAL COMPRA (+IVA)",
              "displayName": "TOTAL COMPRA (+IVA)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "NOMBRE PRODUCTO",
              "displayName": "NOMBRE PRODUCTO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "CANTIDAD",
              "displayName": "CANTIDAD",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "PRECIO UNITARIO",
              "displayName": "PRECIO UNITARIO",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "RESUMEN",
              "displayName": "RESUMEN",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -288,
        688
      ],
      "id": "bdcbbe12-2485-403b-bbd0-1b060ee75634",
      "name": "Escribir sierranevadagranada",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "RCuKUCifcA4jENcY",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "dataTableId": {
          "__rl": true,
          "value": "ghO8HECzTZgPqOqM",
          "mode": "list",
          "cachedResultName": "InformeDiario",
          "cachedResultUrl": "/projects/x5UZcmGQw2OWHuXb/datatables/ghO8HECzTZgPqOqM"
        },
        "filters": {
          "conditions": [
            {
              "keyValue": "1"
            }
          ]
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Contador_Alquiler": "={{ $json.row_number + 1}}",
            "Contador": "={{ $('Get row(s)2').item.json.Contador }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "ID_Documento",
              "displayName": "ID_Documento",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Contador",
              "displayName": "Contador",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Contador_Alquiler",
              "displayName": "Contador_Alquiler",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.dataTable",
      "typeVersion": 1.1,
      "position": [
        -128,
        688
      ],
      "id": "f91d9064-be06-467e-a244-f6f1999fc426",
      "name": "actualizar contador sierranevadagranada"
    },
    {
      "parameters": {
        "operation": "get",
        "dataTableId": {
          "__rl": true,
          "value": "ghO8HECzTZgPqOqM",
          "mode": "list",
          "cachedResultName": "InformeDiario",
          "cachedResultUrl": "/projects/x5UZcmGQw2OWHuXb/datatables/ghO8HECzTZgPqOqM"
        },
        "filters": {
          "conditions": [
            {
              "keyValue": "1"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.dataTable",
      "typeVersion": 1.1,
      "position": [
        -816,
        480
      ],
      "id": "162dccd0-13f7-427e-8032-e9547d607c67",
      "name": "Get row(s)2"
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "simple": false,
        "filters": {
          "q": "from: (reservas@rules-shop.es OR reservas@surfin.es OR reservas@snowdivision.es OR info@sierranevadagranada.com)"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.gmailTrigger",
      "typeVersion": 1.3,
      "position": [
        -976,
        480
      ],
      "id": "424c4c3d-50d2-4125-9517-d6184f95d5d8",
      "name": "Correo",
      "credentials": {
        "gmailOAuth2": {
          "id": "fha7KwAzrDSA7OXO",
          "name": "ventas@sierranevadagranada.com"
        }
      }
    },
    {
      "parameters": {
        "content": "INFORME DIARIO DE ALQUILERES\n",
        "height": 896,
        "width": 1104,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -1008,
        80
      ],
      "id": "62875833-b388-4db3-8958-e726c4d976d9",
      "name": "Sticky Note3"
    }
  ],
  "pinData": {
    "Correo": [
      {
        "json": {
          "id": "19c039ec6dc6136e",
          "threadId": "19c039ec6dc6136e",
          "labelIds": [
            "UNREAD",
            "CATEGORY_PERSONAL",
            "INBOX"
          ],
          "sizeEstimate": 44238,
          "headers": {
            "delivered-to": "Delivered-To: ventas@sierranevadagranada.com",
            "received": "Received: from wn0sdwk0000RF ([20.23.138.213])\r\n        by smtp.gmail.com with ESMTPSA id a640c23a62f3a-b8dbef87254sm92974966b.12.2026.01.28.00.01.01\r\n        (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);\r\n        Wed, 28 Jan 2026 00:01:01 -0800 (PST)",
            "x-forwarded-encrypted": "X-Forwarded-Encrypted: i=1; AJvYcCXNHRE7KsY25a4yfe5VHtHw8VkJKbz2RhfsCYxIsZKuptXsc0AV92lIvL5ZWl2zB9kqR0UPOQ8=@sierranevadagranada.com",
            "x-received": "X-Received: by 2002:a17:907:2d8c:b0:b88:713e:7895 with SMTP id a640c23a62f3a-b8dab2b17c3mr329532066b.3.1769587262487;\r\n        Wed, 28 Jan 2026 00:01:02 -0800 (PST)",
            "arc-seal": "ARC-Seal: i=1; a=rsa-sha256; t=1769587263; cv=none;\r\n        d=google.com; s=arc-20240605;\r\n        b=FZ2QRQwQr19hQRsMMj1chPA59fuLc3AN+pFnrTyaveQtnxN99OElGqhVnEN2FEfbH0\r\n         fbhj8zlxmQsrFGOi+enMyy3cUgVVUcXR7KFevoItflIg+FuwNMpZeVIhj2M18fD+lE2J\r\n         Fm2d6kJeSzbEE7aruCDUy903BC9+zPUaj8XlBvxHBf3LQ3uUDFRd22XRDUINkvUdy00L\r\n         TXuWVKGxLTmVzNWVGZGVcxYnGTvpUxjXAG3elq1g418gTlkGYnV5aj8HjxWk0VMyNSPP\r\n         9snOSfWkoVW94dBUP7pBzPagOwVyowq9Ra7v/cvUxMDXuPVGE1/+Wv9zSOocEhJJaDhu\r\n         S02Q==",
            "arc-message-signature": "ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20240605;\r\n        h=content-transfer-encoding:subject:to:from:mime-version:date\r\n         :message-id:dkim-signature;\r\n        bh=VV8SMduc0XCMZLUMHV/lOau7ElMHJHuHcTY8v30OQCY=;\r\n        fh=6yKT+vrYnXiEfue+t4+nXTbE66SLNfcXc7mBWtjYhc4=;\r\n        b=Y4me/iUCu1+io+7wm4aFxe/T2YXGNnwQ9ogPNJSLRSAcpljAPoSmS7zH3H86wgiG1X\r\n         lJGoA3ceG6B/bYtqjLDcTpjZo7OSDZvmAkl7qzd6CMU4TwpRr8FTctiNGrM/Ro0jVcrc\r\n         U+cKiB5S5DXum8piXBtNx6Mk3qWWMsURaqTBK+BVVDuGPM6Spn8GRe/XXvEXeB0TfVYz\r\n         lWaFMcBT4nGWXwYNF95frmPGZEfzj0en75pdARcBePRYWNepu0oDtw3IcJfZLbgigNft\r\n         HX0gRRTu/m0hUMM9Jbo4h1wj3uir04MHN2FlXzOkWP78pFTQD5arOyRtMLoaNBF5WUny\r\n         JAFw==;\r\n        dara=google.com",
            "arc-authentication-results": "ARC-Authentication-Results: i=1; mx.google.com;\r\n       dkim=pass header.i=@snowdivision-es.20230601.gappssmtp.com header.s=20230601 header.b=FoNoDG7A;\r\n       spf=softfail (google.com: domain of transitioning reservas@snowdivision.es does not designate 209.85.220.65 as permitted sender) smtp.mailfrom=reservas@snowdivision.es;\r\n       dmarc=fail (p=NONE sp=NONE dis=NONE) header.from=snowdivision.es;\r\n       dara=neutral header.i=@sierranevadagranada.com",
            "return-path": "Return-Path: <reservas@snowdivision.es>",
            "received-spf": "Received-SPF: softfail (google.com: domain of transitioning reservas@snowdivision.es does not designate 209.85.220.65 as permitted sender) client-ip=209.85.220.65;",
            "authentication-results": "Authentication-Results: mx.google.com;\r\n       dkim=pass header.i=@snowdivision-es.20230601.gappssmtp.com header.s=20230601 header.b=FoNoDG7A;\r\n       spf=softfail (google.com: domain of transitioning reservas@snowdivision.es does not designate 209.85.220.65 as permitted sender) smtp.mailfrom=reservas@snowdivision.es;\r\n       dmarc=fail (p=NONE sp=NONE dis=NONE) header.from=snowdivision.es;\r\n       dara=neutral header.i=@sierranevadagranada.com",
            "dkim-signature": "DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;\r\n        d=snowdivision-es.20230601.gappssmtp.com; s=20230601; t=1769587263; x=1770192063; darn=sierranevadagranada.com;\r\n        h=content-transfer-encoding:subject:to:from:mime-version:date\r\n         :message-id:from:to:cc:subject:date:message-id:reply-to;\r\n        bh=VV8SMduc0XCMZLUMHV/lOau7ElMHJHuHcTY8v30OQCY=;\r\n        b=FoNoDG7A6vYEKskGubYIyYt8Rp9KEJn58mHc/Q0BIAHTRkkhy9CYBz9SMoFqExOvDW\r\n         aTMjTXV9SZLKF0YaIXtDu1XfE7Pb86doLQXcvaFLBtgbBkOoDLTo1VaMSE7PQYvgSfkB\r\n         UfnS72ualChyCwP12uoRFO+gLvUbRTs36XSXNGYiq78RBHCxojOeUyecAp03NJdcB3zp\r\n         cduWVkXNDWiPpdpwS8xGySCvXssAL4ZemthPcNzp8hIDzeRKYaPsc9HnPPjoYB94WlQp\r\n         wMRZZ0RXxqOTOTNTfEk6oQg+eYjbiwBk7sDgP1oCWOKbrz4ZNy1FOgEtcVmzbjYmYYSr\r\n         SWLg==",
            "x-google-dkim-signature": "X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;\r\n        d=1e100.net; s=20230601; t=1769587263; x=1770192063;\r\n        h=content-transfer-encoding:subject:to:from:mime-version:date\r\n         :message-id:x-gm-gg:x-gm-message-state:from:to:cc:subject:date\r\n         :message-id:reply-to;\r\n        bh=VV8SMduc0XCMZLUMHV/lOau7ElMHJHuHcTY8v30OQCY=;\r\n        b=Q4e2ORi40Z+m4EdrVo7czVA8jg2mbk5HDMXKK8+cJG4QNO4ckgUHJX6xEI9+Xr4HpH\r\n         ALnp4RrAYZMV/l7CzuCi0dOWiL+YBvlRbUL/zFFja8jmQXnRvgWeq9E5SVCDdGXU6C3f\r\n         GqSe7Ljn6L0b/Cp+8uNNXGBHHQ4oYFVQBz7zlLk0YD+QINQ5VMgioLJ2T1f3Mxh6palN\r\n         zBGVjoh0Mg+OUQAsIMjCg1FgkIdf7/7Sp2C2UhRBrHmWxU9Kef2DJjEVjajVJRdQVbjt\r\n         Oq9CQQTt/s4XUHIr/xZCvooMF3aBsusUQm3rGVMDG/bt4Q38Eg6ALgbHuQnz3sCCnPnl\r\n         oD/g==",
            "x-gm-message-state": "X-Gm-Message-State: AOJu0YwfKzTcl+tx0jtlrcgqQ/9t38Z+JorxOB62Ya9dN8c5oAqbUea4\r\n\tfsqj82DwxwRvq3+qh2HPH8VHTe5tvrsvdecH9YORO/tc7ZwWYD+adD1ebVlcpHCJXZnkGa0sdQ/\r\n\t9nbgwZuAFkw==",
            "x-gm-gg": "X-Gm-Gg: AZuq6aJh8xWJIEyXIW0p5V9lrG0MB7/tvDSrfsUeEwxtOaFjhFxI3LZ0FCCaiPoT87j\r\n\tH+J0AF8LjNKyZxZuPAXlV7sJSs9ZzRdV9Ck/2KXTAvpM2/889ewgODy+bPB3j6u2lQ10AOUyRBv\r\n\tUpxm3oX1siKyhkWs0DllVTK3e0h38X3TnsHNplNJqP1KwrwIVUldHAbZdKnNSXungBPAvV6b5OH\r\n\tVlyTDXQfCGxJeZyECFWf9KBOIjvlOznuuGXFWQhvO6J+N9Zv0cRg6Ki3Ac3mn8NotwIB53IiyOR\r\n\t1EtPdfz0OIt8TInruOm5XmPbNIerKSZCql9cmHER/tO/IFjeX6U48BgwB7TOj4mgs7ancasocJx\r\n\tA2CFiHmZzOWfgN7H3RZezJ6hPcEnct34Rq8XNWWbmsbkAoCeGHWpe6q2hNYgGCG+PQfYqSvafPH\r\n\t/DyJ0tYIxRr7BSbdfN0JePGUt1yLxQUl8QsexdcXr4hg==",
            "message-id": "Message-ID: <6979c23d.170a0220.10dd30.b587@mx.google.com>",
            "date": "Date: Wed, 28 Jan 2026 00:01:01 -0800 (PST)",
            "x-google-original-date": "X-Google-Original-Date: 28 Jan 2026 09:01:01 +0100",
            "mime-version": "MIME-Version: 1.0",
            "from": "From: \"reservas@snowdivision.es\" <reservas@snowdivision.es>",
            "to": "To: \"Donna-Liza Diependaal\" <donna.diependaal@gmail.com>",
            "subject": "Subject: Snow Division - Compra efectuada - Donna-Liza Diependaal - canal\r\n Reservas",
            "content-type": "Content-Type: text/html; charset=utf-8",
            "content-transfer-encoding": "Content-Transfer-Encoding: base64"
          },
          "html": "<html><body style=\"font: normal 11pt Calibri, sans-serif, Arial, Verdana, 'Trebuchet MS';color: #333;background-color: #fff;margin: 20px;\"\"><style>p { display: block; margin-before: 1em; margin-after: 1em; margin-start: 0px; margin-end: 0px;}</style><!DOCTYPE html>\n<html lang=\"es\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Plantilla de Email</title>\n</head>\n<body style=\"margin: 0; padding: 0; font-family: 'Arial', 'Helvetica', 'Tahoma', sans-serif; background-color: #111; color: #fff;\">\n    <!-- Cabecera -->\n    <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" style=\"background-color: #111; padding: 20px 0; font-family: 'Arial', 'Helvetica', 'Tahoma', sans-serif;\">\n        <tr>\n            <td align=\"center\">\n                <img src=\"https://snowdivision.es/File/snow-division-white2.png?id=EE5C8EE6-19EA-41DC-81AE-6D67642BE8AB\" alt=\"Snow Division\" style=\"max-height: 60px;\">\n            </td>\n        </tr>\n    </table>\n\n    <!-- Contenido -->\n    <table width=\"100%\" cellspacing=\"0\" cellpadding=\"20\" style=\"background-color: #111; font-family: 'Arial', 'Helvetica', 'Tahoma', sans-serif;\">\n        <tr>\n            <td align=\"center\">\n                <div style=\"max-width: 600px; width: 100%; margin: 0 auto; background-color: #fff; padding: 20px; color: #111; text-align: left; font-size: 16px; line-height: 1.6; border-radius: 5px;\">\n                    <style type=\"text/css\">\n\n/*printing and email cols*/\n.pr-container {\n    padding-left: 15px;\n    padding-right: 15px;  \n}\n.pr-row {\n    margin-left: -15px;\n    margin-right: -15px;\n}  \n.pr-row::after {\n  content: \"\";\n  clear: both;\n  display: block;\n}\n[class*=\"pr-col-\"] {\n  float: left;\n  padding-left: 15px;\n  padding-right: 15px;\n  box-sizing: border-box;\n}\n/* For mobile phones: */\n[class*=\"pr-col-\"] {\n   width: 100%;\n}\n  \n@media print, (min-width: 768px) {\n    /* For desktop: */\n    .pr-col-1 {width: 8.33%;}\n    .pr-col-2 {width: 16.66%;}\n    .pr-col-3 {width: 25%;}\n    .pr-col-4 {width: 33.33%;}\n    .pr-col-5 {width: 41.66%;}\n    .pr-col-6 {width: 50%;}\n    .pr-col-7 {width: 58.33%;}\n    .pr-col-8 {width: 66.66%;}\n    .pr-col-9 {width: 75%;}\n    .pr-col-10 {width: 83.33%;}\n    .pr-col-11 {width: 91.66%;}\n    .pr-col-12 {width: 100%;}\n}\n/*end printing and email cols*/\n\n  .cart-extract-d-none {\n     display: none;\n  }\n  @media print, (min-width: 768px) {\n   .cart-extract-d-none {\n     display: block;\n     width: 100%;\n   } \n   body {\n     /*font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, \"Noto Sans\", sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Noto Color Emoji\";\n     font-size: 16px;\n     font-weight: 400;*/\n  }\n}\n  \nh1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {\n    margin-top: 0;\n    margin-bottom: 0.5rem;\n    font-weight: 500;\n    line-height: 1.2;\n}\nh1 {\n    font-size: 2rem;\n    margin-bottom: 1rem;\n}\nh5 {\n  font-size: 1.25rem;\n}\n  \n.cart-extract-section {\n  margin-bottom: 1em;\n  border: solid 1px #dbdbdb;\n}\n.cart-extract-section-head {\n  background-color: #e9ebed;\n  overflow: hidden;\n  padding: 0.25em 0.5em;\n  font-weight: bold;\n}\n.cart-extract-section-body {\n  padding: 0.5em;\n}\n  \n.cart-extract-payment {\n  border: 1px solid #dbdbdb;\n  padding: 10px;\n  background-color: #e9ebed;\n  margin-bottom: 1em;\n}\n  .cart-extract-warning {\n  \tcolor: #856404;\n    margin-bottom: 1em;\n    padding: 10px;\n    background-color: #fff3cd;\n    border: 1px solid #ffeeba;\n  }\n  \n.cart-line {\n    margin-bottom: 1em;\n    border: solid 1px #dbdbdb;\n}\n.cart-line-header {\n    background-color: #e9ebed;\n    overflow: hidden;\n    line-height: 33px;\n}\n.cart-line-header h4 {\n    padding-bottom: 0;\n    margin: 10px 0;\n    font-weight: bold;\n    font-size: 17px;\n    line-height: 20px;\n}\n.cart-line-actions {\n    padding: 0 10px;\n}\n.cart-line-actions > div {\n    margin: 0 10px;\n    float: left;\n}\n.cart-line-price-panel {\n    float: right !important;\n    padding: 4px 0;\n    font-size: 18px;\n    font-weight: bold;\n    color: #2c3e50;\n}\n.cart-line-quantity-panel input {\n    height: 30px;\n    width: 30px;\n    margin: 4px 0;\n    text-align: center;\n    display: inline;\n}\n  .cart-line-product-img img {\n    width: 100%;\n  }\n  @media print {\n     .cart-line-header h4 {\n        font-size: 14px;\n       \tvertical-align: middle;\n    }\n  }\n.cart-line-product-img {\n    padding: 0;\n}\n.cart-line-details-panel {\n    padding-top: 0.5em;\n    padding-bottom: 0.5em;\n}\n  .cart-extract-totals {\n     width: 6em;\n     display: inline-block;\n  }\n  .cart-line-old-price {\n    font-weight: normal;\n    text-decoration: line-through;\n}\n</style>\n       \n<p>Hola Donna,</p>\n<p>Tu reserva ha sido autorizada.</p>\n<h5>Detalles de la reserva:</h5>\n\n<table cellspacing=\"0\" width=\"100%\" cellpadding=\"5\">\n\t<tr>\n\t\t<td width=\"25%\" style=\"vertical-align:top;border:0\">    \n\t\t\t<table cellspacing=\"5\" class=\"cart-extract-section\" style=\"border:solid 1px #dbdbdb\">\n\t\t\t\t<tr>\n\t\t\t\t\t<td class=\"cart-extract-section-head\" style=\"border:0;background-color:#e9ebed;\">\n\t\t\t\t\t\tDetalles del Pedido\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td class=\"cart-extract-section-body\" style=\"border:0\">\n\t\t\t\t\t\tIdentificador:<br /><b>SO00043743</b><br />\n                        <!---->\n\t\t\t\t\t\tCanal:<br /><b>Reservas</b><br />\n                        <!---->\n\t\t\t\t\t\tFecha de efecto:<br /><b>27/1/2026 11:22</b><br />\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t</td>\n\t\t<td width=\"25%\" style=\"vertical-align:top;border:0\">    \n\t\t\t\n\t\t\t\t<div class=\"cart-extract-d-none\">&nbsp;</div>\n\t\t\t\n\t\t</td>\n\t\t<td width=\"25%\" style=\"vertical-align:top;border:0\">    \n\t\t\t\n\t\t\t\t\n\t\t\t\t\t<table cellspacing=\"5\" class=\"cart-extract-section\" style=\"border:solid 1px #dbdbdb\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"cart-extract-section-head\" style=\"border:0;background-color:#e9ebed;\">\n\t\t\t\t\t\t\t\tDirecci&oacute;n de facturaci&oacute;n\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"cart-extract-section-body\" style=\"border:0\">\n\t\t\t\t\t\t\t\tDonna Diependaal<br />Y9942562K<br />Calle molinillo del aceite 4 2b<br />Malaga<br />29008 (Malaga)<br />ESPAÑA\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t\n\t\t\t\n\t\t</td>\n\t\t<td width=\"25%\" style=\"vertical-align:top;border:0\">    \n\t\t\t<table cellspacing=\"5\" class=\"cart-extract-section\" style=\"border:solid 1px #dbdbdb\">\n\t\t\t\t<tr>\n\t\t\t\t\t<td class=\"cart-extract-section-head\" style=\"border:0;background-color:#e9ebed;\">\n\t\t\t\t\t\tEntidad emisora\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td class=\"cart-extract-section-body\" style=\"border:0\">\n\t\t\t\t\t\tSNOWDIVISION S.L<br />\n\t\t\t\t\t\tCif: B19696988<br />\n\t\t\t\t\t\tPlaza Pradollano 7  <br />\n\t\t\t\t\t\t18196 - Sierra Nevada<br />\n\t\t\t\t\t\t(GRANADA)<br />\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t</td>\n\t</tr>\n</table>\n\n\n<h5>Pagos asociados al pedido:</h5>\n<table cellspacing=\"0\" width=\"100%\" cellpadding=\"5\">\n\t<tr>\n\t\t<td style=\"background-color:#e9ebed;width:20%\">Importe</td>\n\t\t<td style=\"background-color:#e9ebed;width:20%\">Fecha l&iacute;mite</td>\n\t\t<td style=\"background-color:#e9ebed;width:20%\">Método de pago</td>\n\t\t<td style=\"background-color:#e9ebed;width:20%\">Estado</td>\n\t\t<td style=\"background-color:#e9ebed;width:20%\">Acción requerida</td>\n\t</tr>\n\t\t<tr>\n\t\t  <td style=\"background-color:#fff\"><b>144,00&euro;</b></td>\n\t\t  <td style=\"background-color:#fff\"><b>27/01/2026</b></td>\n\t\t  <td style=\"background-color:#fff\"><b>Bank card</b></td>\n\t\t  <td style=\"background-color:#fff\"><b>Efectuado</b></td>\n\t\t  <td style=\"background-color:#fff\"><b>Ninguna</b></td>\n\t\t</tr>\n\t    \n</table>\n\n\n<br />    \n<h5>Detalles del pedido:</h5>\n<div class=\"cart-orderlines-table cart-orderlines-table-readonly document-web-extract\">\n  <div class=\"cart-content\">\n\t    \t\n    \t\n\t\t\n\t\t\t<table width=\"100%\" cellSpacing=\"0\" style=\"margin-bottom:10px;border:solid 1px #dbdbdb\">\n\t\t\t\t<tr class=\"cart-line-header\">\n\t\t\t\t  <td width=\"66%\" style=\"border:0;padding-left:5px;background-color:#e9ebed;margin:8px;\">\n\t\t\t\t\t<h4 style=\"font-size:14px\">Alquiler de casco</h4>\n\t\t\t\t  </td>\n\t\t\t\t  <td width=\"17%\" style=\"border:0;font-size:14px;text-align:center;background-color:#e9ebed;margin:8px;\" class=\"cart-line-actions\">\n\t\t\t\t\t  <span style=\"width: 3em;text-align:center;color:#000;padding:0;border:0;\">1</span>\n\t\t\t\t  </td>\n\t\t\t\t  <td width=\"17%\" style=\"border:0;font-size:14px;text-align:right;font-weight:bold;background-color:#e9ebed;margin:8px;\" class=\"cart-line-actions\">\n\t\t\t\t\t\t\t\t  \n\t\t\t\t\t\t\t<!---->\n\t\t\t\t\t\t14,88&euro;\n\t\t\t\t\t\n\t\t\t\t  </td>\n\t\t\t\t</tr>\n\t\t\t\t<tr class=\"cart-line-data\">\n\t\t\t\t\t<td width=\"100%\" colspan=\"3\">\n\t\t\t\t\t\t<table width=\"100%\" border=\"0\" cellSpacing=\"0\">\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td width=\"25%\" style=\"border:0;vertical-align:top\" class=\"cart-line-product-img\">\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t<img src=\"https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg\" alt=\"Alquiler de casco\" />\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td width=\"75%\" style=\"border:0;vertical-align:top;padding:10px;font-size:0.9em;\" class=\"cart-line-details-panel\">\n\t\t\t\t\tLocalizador: <b>6f223fcb</b><br />\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t<!---->                                  \n\t\t\t\t\t Fecha: <b>18/02/2026</b><br />\n\t\t\t\t\t\t N&uacute;mero de d&iacute;as: <b>3</b><br />\n\t\t\t\t\t\t\t<!----> \n\t\t\t\t\t\t \n\t\t\t\t\t\n\t\t\t\t\t<!---->\n\t\t\t\t\t<!----> \n\t\t\t\t\t\n\t\t\t\t\t\t<!----> \n\t\t\t\t\t\t<!----> \n                    <!---->\n\t\t\t\t\t<!---->\n\t\t\t\t\t\n\t\t\t\t\t<!---->\n\t\t\t\t\t    \n                    <!---->\n\t\t\t\t  </td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t \n\t    \t\n    \t\n\t\t\n\t\t\t<table width=\"100%\" cellSpacing=\"0\" style=\"margin-bottom:10px;border:solid 1px #dbdbdb\">\n\t\t\t\t<tr class=\"cart-line-header\">\n\t\t\t\t  <td width=\"66%\" style=\"border:0;padding-left:5px;background-color:#e9ebed;margin:8px;\">\n\t\t\t\t\t<h4 style=\"font-size:14px\">Alquiler de casco</h4>\n\t\t\t\t  </td>\n\t\t\t\t  <td width=\"17%\" style=\"border:0;font-size:14px;text-align:center;background-color:#e9ebed;margin:8px;\" class=\"cart-line-actions\">\n\t\t\t\t\t  <span style=\"width: 3em;text-align:center;color:#000;padding:0;border:0;\">1</span>\n\t\t\t\t  </td>\n\t\t\t\t  <td width=\"17%\" style=\"border:0;font-size:14px;text-align:right;font-weight:bold;background-color:#e9ebed;margin:8px;\" class=\"cart-line-actions\">\n\t\t\t\t\t\t\t\t  \n\t\t\t\t\t\t\t<!---->\n\t\t\t\t\t\t14,88&euro;\n\t\t\t\t\t\n\t\t\t\t  </td>\n\t\t\t\t</tr>\n\t\t\t\t<tr class=\"cart-line-data\">\n\t\t\t\t\t<td width=\"100%\" colspan=\"3\">\n\t\t\t\t\t\t<table width=\"100%\" border=\"0\" cellSpacing=\"0\">\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td width=\"25%\" style=\"border:0;vertical-align:top\" class=\"cart-line-product-img\">\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t<img src=\"https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg\" alt=\"Alquiler de casco\" />\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td width=\"75%\" style=\"border:0;vertical-align:top;padding:10px;font-size:0.9em;\" class=\"cart-line-details-panel\">\n\t\t\t\t\tLocalizador: <b>819a1a34</b><br />\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t<!---->                                  \n\t\t\t\t\t Fecha: <b>18/02/2026</b><br />\n\t\t\t\t\t\t N&uacute;mero de d&iacute;as: <b>3</b><br />\n\t\t\t\t\t\t\t<!----> \n\t\t\t\t\t\t \n\t\t\t\t\t\n\t\t\t\t\t<!---->\n\t\t\t\t\t<!----> \n\t\t\t\t\t\n\t\t\t\t\t\t<!----> \n\t\t\t\t\t\t<!----> \n                    <!---->\n\t\t\t\t\t<!---->\n\t\t\t\t\t\n\t\t\t\t\t<!---->\n\t\t\t\t\t    \n                    <!---->\n\t\t\t\t  </td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t \n\t    \t\n    \t\n\t\t\n\t\t\t<table width=\"100%\" cellSpacing=\"0\" style=\"margin-bottom:10px;border:solid 1px #dbdbdb\">\n\t\t\t\t<tr class=\"cart-line-header\">\n\t\t\t\t  <td width=\"66%\" style=\"border:0;padding-left:5px;background-color:#e9ebed;margin:8px;\">\n\t\t\t\t\t<h4 style=\"font-size:14px\">Alquiler de casco</h4>\n\t\t\t\t  </td>\n\t\t\t\t  <td width=\"17%\" style=\"border:0;font-size:14px;text-align:center;background-color:#e9ebed;margin:8px;\" class=\"cart-line-actions\">\n\t\t\t\t\t  <span style=\"width: 3em;text-align:center;color:#000;padding:0;border:0;\">1</span>\n\t\t\t\t  </td>\n\t\t\t\t  <td width=\"17%\" style=\"border:0;font-size:14px;text-align:right;font-weight:bold;background-color:#e9ebed;margin:8px;\" class=\"cart-line-actions\">\n\t\t\t\t\t\t\t\t  \n\t\t\t\t\t\t\t<!---->\n\t\t\t\t\t\t14,88&euro;\n\t\t\t\t\t\n\t\t\t\t  </td>\n\t\t\t\t</tr>\n\t\t\t\t<tr class=\"cart-line-data\">\n\t\t\t\t\t<td width=\"100%\" colspan=\"3\">\n\t\t\t\t\t\t<table width=\"100%\" border=\"0\" cellSpacing=\"0\">\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td width=\"25%\" style=\"border:0;vertical-align:top\" class=\"cart-line-product-img\">\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t<img src=\"https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg\" alt=\"Alquiler de casco\" />\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td width=\"75%\" style=\"border:0;vertical-align:top;padding:10px;font-size:0.9em;\" class=\"cart-line-details-panel\">\n\t\t\t\t\tLocalizador: <b>94e019ea</b><br />\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t<!---->                                  \n\t\t\t\t\t Fecha: <b>18/02/2026</b><br />\n\t\t\t\t\t\t N&uacute;mero de d&iacute;as: <b>3</b><br />\n\t\t\t\t\t\t\t<!----> \n\t\t\t\t\t\t \n\t\t\t\t\t\n\t\t\t\t\t<!---->\n\t\t\t\t\t<!----> \n\t\t\t\t\t\n\t\t\t\t\t\t<!----> \n\t\t\t\t\t\t<!----> \n                    <!---->\n\t\t\t\t\t<!---->\n\t\t\t\t\t\n\t\t\t\t\t<!---->\n\t\t\t\t\t    \n                    <!---->\n\t\t\t\t  </td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t \n\t    \t\n    \t\n\t\t\n\t\t\t<table width=\"100%\" cellSpacing=\"0\" style=\"margin-bottom:10px;border:solid 1px #dbdbdb\">\n\t\t\t\t<tr class=\"cart-line-header\">\n\t\t\t\t  <td width=\"66%\" style=\"border:0;padding-left:5px;background-color:#e9ebed;margin:8px;\">\n\t\t\t\t\t<h4 style=\"font-size:14px\">Alquiler de casco</h4>\n\t\t\t\t  </td>\n\t\t\t\t  <td width=\"17%\" style=\"border:0;font-size:14px;text-align:center;background-color:#e9ebed;margin:8px;\" class=\"cart-line-actions\">\n\t\t\t\t\t  <span style=\"width: 3em;text-align:center;color:#000;padding:0;border:0;\">1</span>\n\t\t\t\t  </td>\n\t\t\t\t  <td width=\"17%\" style=\"border:0;font-size:14px;text-align:right;font-weight:bold;background-color:#e9ebed;margin:8px;\" class=\"cart-line-actions\">\n\t\t\t\t\t\t\t\t  \n\t\t\t\t\t\t\t<!---->\n\t\t\t\t\t\t14,88&euro;\n\t\t\t\t\t\n\t\t\t\t  </td>\n\t\t\t\t</tr>\n\t\t\t\t<tr class=\"cart-line-data\">\n\t\t\t\t\t<td width=\"100%\" colspan=\"3\">\n\t\t\t\t\t\t<table width=\"100%\" border=\"0\" cellSpacing=\"0\">\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td width=\"25%\" style=\"border:0;vertical-align:top\" class=\"cart-line-product-img\">\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t<img src=\"https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg\" alt=\"Alquiler de casco\" />\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td width=\"75%\" style=\"border:0;vertical-align:top;padding:10px;font-size:0.9em;\" class=\"cart-line-details-panel\">\n\t\t\t\t\tLocalizador: <b>3a85ec17</b><br />\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t<!---->                                  \n\t\t\t\t\t Fecha: <b>18/02/2026</b><br />\n\t\t\t\t\t\t N&uacute;mero de d&iacute;as: <b>3</b><br />\n\t\t\t\t\t\t\t<!----> \n\t\t\t\t\t\t \n\t\t\t\t\t\n\t\t\t\t\t<!---->\n\t\t\t\t\t<!----> \n\t\t\t\t\t\n\t\t\t\t\t\t<!----> \n\t\t\t\t\t\t<!----> \n                    <!---->\n\t\t\t\t\t<!---->\n\t\t\t\t\t\n\t\t\t\t\t<!---->\n\t\t\t\t\t    \n                    <!---->\n\t\t\t\t  </td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t \n\t    \t\n    \t\n\t\t\n\t\t\t<table width=\"100%\" cellSpacing=\"0\" style=\"margin-bottom:10px;border:solid 1px #dbdbdb\">\n\t\t\t\t<tr class=\"cart-line-header\">\n\t\t\t\t  <td width=\"66%\" style=\"border:0;padding-left:5px;background-color:#e9ebed;margin:8px;\">\n\t\t\t\t\t<h4 style=\"font-size:14px\">Alquiler de casco</h4>\n\t\t\t\t  </td>\n\t\t\t\t  <td width=\"17%\" style=\"border:0;font-size:14px;text-align:center;background-color:#e9ebed;margin:8px;\" class=\"cart-line-actions\">\n\t\t\t\t\t  <span style=\"width: 3em;text-align:center;color:#000;padding:0;border:0;\">1</span>\n\t\t\t\t  </td>\n\t\t\t\t  <td width=\"17%\" style=\"border:0;font-size:14px;text-align:right;font-weight:bold;background-color:#e9ebed;margin:8px;\" class=\"cart-line-actions\">\n\t\t\t\t\t\t\t\t  \n\t\t\t\t\t\t\t<!---->\n\t\t\t\t\t\t14,88&euro;\n\t\t\t\t\t\n\t\t\t\t  </td>\n\t\t\t\t</tr>\n\t\t\t\t<tr class=\"cart-line-data\">\n\t\t\t\t\t<td width=\"100%\" colspan=\"3\">\n\t\t\t\t\t\t<table width=\"100%\" border=\"0\" cellSpacing=\"0\">\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td width=\"25%\" style=\"border:0;vertical-align:top\" class=\"cart-line-product-img\">\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t<img src=\"https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg\" alt=\"Alquiler de casco\" />\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td width=\"75%\" style=\"border:0;vertical-align:top;padding:10px;font-size:0.9em;\" class=\"cart-line-details-panel\">\n\t\t\t\t\tLocalizador: <b>30154bee</b><br />\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t<!---->                                  \n\t\t\t\t\t Fecha: <b>18/02/2026</b><br />\n\t\t\t\t\t\t N&uacute;mero de d&iacute;as: <b>3</b><br />\n\t\t\t\t\t\t\t<!----> \n\t\t\t\t\t\t \n\t\t\t\t\t\n\t\t\t\t\t<!---->\n\t\t\t\t\t<!----> \n\t\t\t\t\t\n\t\t\t\t\t\t<!----> \n\t\t\t\t\t\t<!----> \n                    <!---->\n\t\t\t\t\t<!---->\n\t\t\t\t\t\n\t\t\t\t\t<!---->\n\t\t\t\t\t    \n                    <!---->\n\t\t\t\t  </td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t \n\t    \t\n    \t\n\t\t\n\t\t\t<table width=\"100%\" cellSpacing=\"0\" style=\"margin-bottom:10px;border:solid 1px #dbdbdb\">\n\t\t\t\t<tr class=\"cart-line-header\">\n\t\t\t\t  <td width=\"66%\" style=\"border:0;padding-left:5px;background-color:#e9ebed;margin:8px;\">\n\t\t\t\t\t<h4 style=\"font-size:14px\">Alquiler de casco</h4>\n\t\t\t\t  </td>\n\t\t\t\t  <td width=\"17%\" style=\"border:0;font-size:14px;text-align:center;background-color:#e9ebed;margin:8px;\" class=\"cart-line-actions\">\n\t\t\t\t\t  <span style=\"width: 3em;text-align:center;color:#000;padding:0;border:0;\">1</span>\n\t\t\t\t  </td>\n\t\t\t\t  <td width=\"17%\" style=\"border:0;font-size:14px;text-align:right;font-weight:bold;background-color:#e9ebed;margin:8px;\" class=\"cart-line-actions\">\n\t\t\t\t\t\t\t\t  \n\t\t\t\t\t\t\t<!---->\n\t\t\t\t\t\t14,88&euro;\n\t\t\t\t\t\n\t\t\t\t  </td>\n\t\t\t\t</tr>\n\t\t\t\t<tr class=\"cart-line-data\">\n\t\t\t\t\t<td width=\"100%\" colspan=\"3\">\n\t\t\t\t\t\t<table width=\"100%\" border=\"0\" cellSpacing=\"0\">\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td width=\"25%\" style=\"border:0;vertical-align:top\" class=\"cart-line-product-img\">\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t<img src=\"https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg\" alt=\"Alquiler de casco\" />\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td width=\"75%\" style=\"border:0;vertical-align:top;padding:10px;font-size:0.9em;\" class=\"cart-line-details-panel\">\n\t\t\t\t\tLocalizador: <b>5124c551</b><br />\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t<!---->                                  \n\t\t\t\t\t Fecha: <b>18/02/2026</b><br />\n\t\t\t\t\t\t N&uacute;mero de d&iacute;as: <b>3</b><br />\n\t\t\t\t\t\t\t<!----> \n\t\t\t\t\t\t \n\t\t\t\t\t\n\t\t\t\t\t<!---->\n\t\t\t\t\t<!----> \n\t\t\t\t\t\n\t\t\t\t\t\t<!----> \n\t\t\t\t\t\t<!----> \n                    <!---->\n\t\t\t\t\t<!---->\n\t\t\t\t\t\n\t\t\t\t\t<!---->\n\t\t\t\t\t    \n                    <!---->\n\t\t\t\t  </td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t \n\t    \t\n    \t\n\t\t\n\t\t\t<table width=\"100%\" cellSpacing=\"0\" style=\"margin-bottom:10px;border:solid 1px #dbdbdb\">\n\t\t\t\t<tr class=\"cart-line-header\">\n\t\t\t\t  <td width=\"66%\" style=\"border:0;padding-left:5px;background-color:#e9ebed;margin:8px;\">\n\t\t\t\t\t<h4 style=\"font-size:14px\">Alquiler de casco</h4>\n\t\t\t\t  </td>\n\t\t\t\t  <td width=\"17%\" style=\"border:0;font-size:14px;text-align:center;background-color:#e9ebed;margin:8px;\" class=\"cart-line-actions\">\n\t\t\t\t\t  <span style=\"width: 3em;text-align:center;color:#000;padding:0;border:0;\">1</span>\n\t\t\t\t  </td>\n\t\t\t\t  <td width=\"17%\" style=\"border:0;font-size:14px;text-align:right;font-weight:bold;background-color:#e9ebed;margin:8px;\" class=\"cart-line-actions\">\n\t\t\t\t\t\t\t\t  \n\t\t\t\t\t\t\t<!---->\n\t\t\t\t\t\t14,88&euro;\n\t\t\t\t\t\n\t\t\t\t  </td>\n\t\t\t\t</tr>\n\t\t\t\t<tr class=\"cart-line-data\">\n\t\t\t\t\t<td width=\"100%\" colspan=\"3\">\n\t\t\t\t\t\t<table width=\"100%\" border=\"0\" cellSpacing=\"0\">\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td width=\"25%\" style=\"border:0;vertical-align:top\" class=\"cart-line-product-img\">\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t<img src=\"https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg\" alt=\"Alquiler de casco\" />\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td width=\"75%\" style=\"border:0;vertical-align:top;padding:10px;font-size:0.9em;\" class=\"cart-line-details-panel\">\n\t\t\t\t\tLocalizador: <b>26bf5c5c</b><br />\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t<!---->                                  \n\t\t\t\t\t Fecha: <b>18/02/2026</b><br />\n\t\t\t\t\t\t N&uacute;mero de d&iacute;as: <b>3</b><br />\n\t\t\t\t\t\t\t<!----> \n\t\t\t\t\t\t \n\t\t\t\t\t\n\t\t\t\t\t<!---->\n\t\t\t\t\t<!----> \n\t\t\t\t\t\n\t\t\t\t\t\t<!----> \n\t\t\t\t\t\t<!----> \n                    <!---->\n\t\t\t\t\t<!---->\n\t\t\t\t\t\n\t\t\t\t\t<!---->\n\t\t\t\t\t    \n                    <!---->\n\t\t\t\t  </td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t \n\t    \t\n    \t\n\t\t\n\t\t\t<table width=\"100%\" cellSpacing=\"0\" style=\"margin-bottom:10px;border:solid 1px #dbdbdb\">\n\t\t\t\t<tr class=\"cart-line-header\">\n\t\t\t\t  <td width=\"66%\" style=\"border:0;padding-left:5px;background-color:#e9ebed;margin:8px;\">\n\t\t\t\t\t<h4 style=\"font-size:14px\">Alquiler de casco</h4>\n\t\t\t\t  </td>\n\t\t\t\t  <td width=\"17%\" style=\"border:0;font-size:14px;text-align:center;background-color:#e9ebed;margin:8px;\" class=\"cart-line-actions\">\n\t\t\t\t\t  <span style=\"width: 3em;text-align:center;color:#000;padding:0;border:0;\">1</span>\n\t\t\t\t  </td>\n\t\t\t\t  <td width=\"17%\" style=\"border:0;font-size:14px;text-align:right;font-weight:bold;background-color:#e9ebed;margin:8px;\" class=\"cart-line-actions\">\n\t\t\t\t\t\t\t\t  \n\t\t\t\t\t\t\t<!---->\n\t\t\t\t\t\t14,88&euro;\n\t\t\t\t\t\n\t\t\t\t  </td>\n\t\t\t\t</tr>\n\t\t\t\t<tr class=\"cart-line-data\">\n\t\t\t\t\t<td width=\"100%\" colspan=\"3\">\n\t\t\t\t\t\t<table width=\"100%\" border=\"0\" cellSpacing=\"0\">\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td width=\"25%\" style=\"border:0;vertical-align:top\" class=\"cart-line-product-img\">\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t<img src=\"https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg\" alt=\"Alquiler de casco\" />\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td width=\"75%\" style=\"border:0;vertical-align:top;padding:10px;font-size:0.9em;\" class=\"cart-line-details-panel\">\n\t\t\t\t\tLocalizador: <b>fb10aad2</b><br />\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t<!---->                                  \n\t\t\t\t\t Fecha: <b>18/02/2026</b><br />\n\t\t\t\t\t\t N&uacute;mero de d&iacute;as: <b>3</b><br />\n\t\t\t\t\t\t\t<!----> \n\t\t\t\t\t\t \n\t\t\t\t\t\n\t\t\t\t\t<!---->\n\t\t\t\t\t<!----> \n\t\t\t\t\t\n\t\t\t\t\t\t<!----> \n\t\t\t\t\t\t<!----> \n                    <!---->\n\t\t\t\t\t<!---->\n\t\t\t\t\t\n\t\t\t\t\t<!---->\n\t\t\t\t\t    \n                    <!---->\n\t\t\t\t  </td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t \n\t\n  </div>\n</div>\n\n<div style=\"text-align:right;margin-right:5px\">\n</div>\n<div style=\"text-align:right;margin-right:5px;margin-top:3px\"><b>TOTAL: <span class=\"cart-extract-totals\">144,00</span></b></div>\n\n\n   <div style=\"text-align:right\"><p>Precios con IVA incluido.</p></div>\n\n\n\n<p>Puedes imprimir el justificante de compra haciendo click en este <a href=\"https://rules-shop.es/documentWebExtract?orderGuid=908eb0ea-9f4b-47fd-8e03-3481cfc0a8a3\">enlace</a>.</p>\n\n<p>Si no puedes usar el enlace puedes pegar la siguiente dirección en tu navegador:<br />\nhttps://rules-shop.es/documentWebExtract?orderGuid=908eb0ea-9f4b-47fd-8e03-3481cfc0a8a3</p>\n\n<p><b>INFORMACIÓN DE INTERÉS</b></p>\n<p><b>Lea atentamente las condiciones generales de reserva adjuntas</b></p>\n\n<p><span style=\"color:red; text-decoration:underline;\">Recuerde llegar con al menos 2 horas de antelación, de la hora de su clase, a recoger el material para equiparse, evitar colas y llegar a tiempo, para que tenga una experiencia inmejorable.</p>\n\n<p style=\"text-decoration:underline\"><b>MATERIAL</b></p>\n<p>\nEsta es la dirección para retirar el material:<br />\n<div class=\"ink-recogida row pr-row\">\n    <div class=\"col-md-3 col-lg-2 pr-col-3 logo\">\n        <img src=\"https://sierranevadagranada.com/File/logo-rules-small.png?id=B7EBE528-B54D-4AB9-8CEF-AE5F6B213748\" style=\"max-width:100%\" />\n    </div>\n    <div class=\"col-md-6 col-lg-7 pr-col-6 info\">\n        <h5>RULES SIERRA NEVADA</h5>\n        <p>Plaza de Andalucía, Edificio Monachil, locales 1 y 2.</p>\n        <p>Frente al parking de autobuses.</p>\n    </div>\n    <div class=\"col-md-3 col-lg-3 pr-col-3 ubicacion\">\n        <i class=\"fas fa-map-marked-alt\"></i>\n        <a href=\"https://goo.gl/maps/eUAjCiksJHQUwMPb7\" target=\"_blank\">Ver en mapa</a>\n    </div>\n</div>\n</p>\n<p>Presenta este código QR en la tienda de alquiler para recoger el material más rápidamente:</p>\n<br />\n<img src=\"https://snowdivision.es/res/qrImage/SO00043743.gif\" style=\"width: 150px;\"/>\n<p><br /></p>\n<p>Puedes venir el día de antes a recoger el material desde 18:30h hasta cierre de tienda, así evitas colas o retrasos.</p>\n\n<p>HORARIO TIENDA<br />\nTodos los días de 8:00h a 20:00h<br />\n* Los horarios o servicios pueden modificarse\n</p>\n\n<br/>\n<p style=\"text-decoration:underline\"><b>INFORMACIÓN EXCLUSIVA PARA CLIENTES CON CLASES CONTRATADAS</b></p>\n<p>El punto de encuentro para las CLASES se encuentra en nuestra oficina ubicada en Borreguiles en la salida del telecabina Al-Andalus a la derecha. SURFIN SIERRA NEVADA.</p>\n<p>Ante cualquier problema con la hora de llegada o localización del punto de encuentro de pistas (Borreguiles) llame con tiempo al <b>638 877 288</b> (teléfono de la Escuela).</p>\n\n<p style=\"text-decoration:underline\"><b>MUY IMPORTANTE – PARA CLIENTES CON RESERVAS DE CURSILLOS COLECTIVOS </b></p>\n<p>El curso se realizará en grupos de 4 a 10 personas según el nivel.</p>\n<p>Si no se llega a completar un mínimo de 4 personas, el curso se verá reducido de 2 horas a 1 hora y de 4 horas a 2 horas, respectivamente. En caso de no llegar a un mínimo de 2 personas, el curso podría verse anulado o modificado, dando la empresa otras opciones.</p>\n<p>Las clases comenzarán a la hora establecida en el bono de confirmación de reserva, independientemente del número de alumnos presentes. Si llegase tarde al punto de encuentro en Borreguiles por causas ajenas a nuestra empresa, <b>el tiempo no será recuperable y si este tiempo excede de 20 minutos de la hora de inicio, no será posible incorporarse al cursillo por motivos del progreso de aprendizaje</b>.</p>\n<p><b>FORFAIT</b> para acceder a pistas imprescindible <b>no incluido en los cursillos</b>.</p>\n\n<p style=\"text-decoration:underline\"><b>MUY IMPORTANTE – PARA CLIENTES CON RESERVAS DE CLASES PARTICULARES </b></p>\n<p>Las clases comenzarán a la hora establecida en el bono de confirmación de reserva, independientemente del número de alumnos presentes. Si llegase tarde al punto de encuentro en Borreguiles por causas ajenas a nuestra empresa, <b>el tiempo no será recuperable y si este tiempo excede de 20 minutos de la hora de inicio, se pierde el derecho a dar la clase</b>.</p>\n<p><b>FORFAIT</b> para acceder a pistas imprescindible <b>no incluido en los cursillos</b>.</p>\n<br/>\n<p><b>Por favor, si hay algún error póngase en contacto nuevamente para solucionarlo. No nos hacemos responsables de errores no notificados.</b></p>\n                </div>\n            </td>\n        </tr>\n    </table>\n\n    <!-- Pie -->\n    <table width=\"100%\" cellspacing=\"0\" cellpadding=\"20\" style=\"background-color: #111; font-family: 'Arial', 'Helvetica', 'Tahoma', sans-serif;\">\n        <tr>\n            <td align=\"center\" style=\"color: #474747; font-size: 14px;\">\n                <div style=\"max-width: 600px; width: 100%; margin: 0 auto; text-align: center;\">\n                    <p style=\"margin: 0; color: #474747;\">Plaza de Pradollano número 7, 18196, Sierra Nevada, Granada</p>\n                    <p style=\"margin: 10px 0;\">\n                        <a href=\"https://snowdivision.es/politica-de-privacidad\" style=\"color: #e75d15; text-decoration: none; margin: 0 10px;\">Política de privacidad</a> | \n                        <a href=\"https://snowdivision.es/terminos-y-condiciones\" style=\"color: #e75d15; text-decoration: none; margin: 0 10px;\">Términos y condiciones</a> | \n                        <a href=\"https://snowdivision.es/politica-de-cancelacion\" style=\"color: #e75d15; text-decoration: none; margin: 0 10px;\">Política de cancelación</a>\n                    </p>\n                </div>\n            </td>\n        </tr>\n    </table>\n</body>\n</html>\n<br/><span style='color:white'>(Mensaje:d59debb5-5296-4741-b8ef-2a256ce1ed37)</span><br/></body></html>",
          "text": "Plantilla de Email\n\nSnow Division\n[https://snowdivision.es/File/snow-division-white2.png?id=EE5C8EE6-19EA-41DC-81AE-6D67642BE8AB]\n\nHola Donna,\n\nTu reserva ha sido autorizada.\n\nDETALLES DE LA RESERVA:\n\nDetalles del Pedido Identificador:\nSO00043743\nCanal:\nReservas\nFecha de efecto:\n27/1/2026 11:22\n\n\n \n\nDirección de facturación Donna Diependaal\nY9942562K\nCalle molinillo del aceite 4 2b\nMalaga\n29008 (Malaga)\nESPAÑA\n\nEntidad emisora SNOWDIVISION S.L\nCif: B19696988\nPlaza Pradollano 7\n18196 - Sierra Nevada\n(GRANADA)\n\n\nPAGOS ASOCIADOS AL PEDIDO:\n\nImporte Fecha límite Método de pago Estado Acción requerida 144,00€ 27/01/2026\nBank card Efectuado Ninguna\n\n\nDETALLES DEL PEDIDO:\n\nALQUILER DE CASCO\n\n1 14,88€\nAlquiler de casco\n[https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg]\nLocalizador: 6f223fcb\nFecha: 18/02/2026\nNúmero de días: 3\n\n\nALQUILER DE CASCO\n\n1 14,88€\nAlquiler de casco\n[https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg]\nLocalizador: 819a1a34\nFecha: 18/02/2026\nNúmero de días: 3\n\n\nALQUILER DE CASCO\n\n1 14,88€\nAlquiler de casco\n[https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg]\nLocalizador: 94e019ea\nFecha: 18/02/2026\nNúmero de días: 3\n\n\nALQUILER DE CASCO\n\n1 14,88€\nAlquiler de casco\n[https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg]\nLocalizador: 3a85ec17\nFecha: 18/02/2026\nNúmero de días: 3\n\n\nALQUILER DE CASCO\n\n1 14,88€\nAlquiler de casco\n[https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg]\nLocalizador: 30154bee\nFecha: 18/02/2026\nNúmero de días: 3\n\n\nALQUILER DE CASCO\n\n1 14,88€\nAlquiler de casco\n[https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg]\nLocalizador: 5124c551\nFecha: 18/02/2026\nNúmero de días: 3\n\n\nALQUILER DE CASCO\n\n1 14,88€\nAlquiler de casco\n[https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg]\nLocalizador: 26bf5c5c\nFecha: 18/02/2026\nNúmero de días: 3\n\n\nALQUILER DE CASCO\n\n1 14,88€\nAlquiler de casco\n[https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg]\nLocalizador: fb10aad2\nFecha: 18/02/2026\nNúmero de días: 3\n\n\n\nTOTAL: 144,00\n\nPrecios con IVA incluido.\n\nPuedes imprimir el justificante de compra haciendo click en este enlace\n[https://rules-shop.es/documentWebExtract?orderGuid=908eb0ea-9f4b-47fd-8e03-3481cfc0a8a3].\n\nSi no puedes usar el enlace puedes pegar la siguiente dirección en tu navegador:\nhttps://rules-shop.es/documentWebExtract?orderGuid=908eb0ea-9f4b-47fd-8e03-3481cfc0a8a3\n\nINFORMACIÓN DE INTERÉS\n\nLea atentamente las condiciones generales de reserva adjuntas\n\nRecuerde llegar con al menos 2 horas de antelación, de la hora de su clase, a\nrecoger el material para equiparse, evitar colas y llegar a tiempo, para que\ntenga una experiencia inmejorable.\n\nMATERIAL\n\nEsta es la dirección para retirar el material:\n\n\n[https://sierranevadagranada.com/File/logo-rules-small.png?id=B7EBE528-B54D-4AB9-8CEF-AE5F6B213748]\n\nRULES SIERRA NEVADA\n\nPlaza de Andalucía, Edificio Monachil, locales 1 y 2.\n\nFrente al parking de autobuses.\n\nVer en mapa [https://goo.gl/maps/eUAjCiksJHQUwMPb7]\n\n\n\nPresenta este código QR en la tienda de alquiler para recoger el material más\nrápidamente:\n\n\n[https://snowdivision.es/res/qrImage/SO00043743.gif]\n\n\n\n\nPuedes venir el día de antes a recoger el material desde 18:30h hasta cierre de\ntienda, así evitas colas o retrasos.\n\nHORARIO TIENDA\nTodos los días de 8:00h a 20:00h\n* Los horarios o servicios pueden modificarse\n\n\nINFORMACIÓN EXCLUSIVA PARA CLIENTES CON CLASES CONTRATADAS\n\nEl punto de encuentro para las CLASES se encuentra en nuestra oficina ubicada en\nBorreguiles en la salida del telecabina Al-Andalus a la derecha. SURFIN SIERRA\nNEVADA.\n\nAnte cualquier problema con la hora de llegada o localización del punto de\nencuentro de pistas (Borreguiles) llame con tiempo al 638 877 288 (teléfono de\nla Escuela).\n\nMUY IMPORTANTE – PARA CLIENTES CON RESERVAS DE CURSILLOS COLECTIVOS\n\nEl curso se realizará en grupos de 4 a 10 personas según el nivel.\n\nSi no se llega a completar un mínimo de 4 personas, el curso se verá reducido de\n2 horas a 1 hora y de 4 horas a 2 horas, respectivamente. En caso de no llegar a\nun mínimo de 2 personas, el curso podría verse anulado o modificado, dando la\nempresa otras opciones.\n\nLas clases comenzarán a la hora establecida en el bono de confirmación de\nreserva, independientemente del número de alumnos presentes. Si llegase tarde al\npunto de encuentro en Borreguiles por causas ajenas a nuestra empresa, el tiempo\nno será recuperable y si este tiempo excede de 20 minutos de la hora de inicio,\nno será posible incorporarse al cursillo por motivos del progreso de\naprendizaje.\n\nFORFAIT para acceder a pistas imprescindible no incluido en los cursillos.\n\nMUY IMPORTANTE – PARA CLIENTES CON RESERVAS DE CLASES PARTICULARES\n\nLas clases comenzarán a la hora establecida en el bono de confirmación de\nreserva, independientemente del número de alumnos presentes. Si llegase tarde al\npunto de encuentro en Borreguiles por causas ajenas a nuestra empresa, el tiempo\nno será recuperable y si este tiempo excede de 20 minutos de la hora de inicio,\nse pierde el derecho a dar la clase.\n\nFORFAIT para acceder a pistas imprescindible no incluido en los cursillos.\n\n\nPor favor, si hay algún error póngase en contacto nuevamente para solucionarlo.\nNo nos hacemos responsables de errores no notificados.\n\nPlaza de Pradollano número 7, 18196, Sierra Nevada, Granada\n\nPolítica de privacidad [https://snowdivision.es/politica-de-privacidad] |\nTérminos y condiciones [https://snowdivision.es/terminos-y-condiciones] |\nPolítica de cancelación [https://snowdivision.es/politica-de-cancelacion]\n\n\n(Mensaje:d59debb5-5296-4741-b8ef-2a256ce1ed37)\n",
          "textAsHtml": "<p>Plantilla de Email</p><p>Snow Division<br/>[<a href=\"https://snowdivision.es/File/snow-division-white2.png?id=EE5C8EE6-19EA-41DC-81AE-6D67642BE8AB\">https://snowdivision.es/File/snow-division-white2.png?id=EE5C8EE6-19EA-41DC-81AE-6D67642BE8AB</a>]</p><p>Hola Donna,</p><p>Tu reserva ha sido autorizada.</p><p>DETALLES DE LA RESERVA:</p><p>Detalles del Pedido Identificador:<br/>SO00043743<br/>Canal:<br/>Reservas<br/>Fecha de efecto:<br/>27/1/2026 11:22</p><p>&nbsp;</p><p>Direcci&oacute;n de facturaci&oacute;n Donna Diependaal<br/>Y9942562K<br/>Calle molinillo del aceite 4 2b<br/>Malaga<br/>29008 (Malaga)<br/>ESPA&Ntilde;A</p><p>Entidad emisora SNOWDIVISION S.L<br/>Cif: B19696988<br/>Plaza Pradollano 7<br/>18196 - Sierra Nevada<br/>(GRANADA)</p><p>PAGOS ASOCIADOS AL PEDIDO:</p><p>Importe Fecha l&iacute;mite M&eacute;todo de pago Estado Acci&oacute;n requerida 144,00&euro; 27/01/2026<br/>Bank card Efectuado Ninguna</p><p>DETALLES DEL PEDIDO:</p><p>ALQUILER DE CASCO</p><p>1 14,88&euro;<br/>Alquiler de casco<br/>[<a href=\"https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg\">https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg</a>]<br/>Localizador: 6f223fcb<br/>Fecha: 18/02/2026<br/>N&uacute;mero de d&iacute;as: 3</p><p>ALQUILER DE CASCO</p><p>1 14,88&euro;<br/>Alquiler de casco<br/>[<a href=\"https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg\">https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg</a>]<br/>Localizador: 819a1a34<br/>Fecha: 18/02/2026<br/>N&uacute;mero de d&iacute;as: 3</p><p>ALQUILER DE CASCO</p><p>1 14,88&euro;<br/>Alquiler de casco<br/>[<a href=\"https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg\">https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg</a>]<br/>Localizador: 94e019ea<br/>Fecha: 18/02/2026<br/>N&uacute;mero de d&iacute;as: 3</p><p>ALQUILER DE CASCO</p><p>1 14,88&euro;<br/>Alquiler de casco<br/>[<a href=\"https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg\">https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg</a>]<br/>Localizador: 3a85ec17<br/>Fecha: 18/02/2026<br/>N&uacute;mero de d&iacute;as: 3</p><p>ALQUILER DE CASCO</p><p>1 14,88&euro;<br/>Alquiler de casco<br/>[<a href=\"https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg\">https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg</a>]<br/>Localizador: 30154bee<br/>Fecha: 18/02/2026<br/>N&uacute;mero de d&iacute;as: 3</p><p>ALQUILER DE CASCO</p><p>1 14,88&euro;<br/>Alquiler de casco<br/>[<a href=\"https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg\">https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg</a>]<br/>Localizador: 5124c551<br/>Fecha: 18/02/2026<br/>N&uacute;mero de d&iacute;as: 3</p><p>ALQUILER DE CASCO</p><p>1 14,88&euro;<br/>Alquiler de casco<br/>[<a href=\"https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg\">https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg</a>]<br/>Localizador: 26bf5c5c<br/>Fecha: 18/02/2026<br/>N&uacute;mero de d&iacute;as: 3</p><p>ALQUILER DE CASCO</p><p>1 14,88&euro;<br/>Alquiler de casco<br/>[<a href=\"https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg\">https://snowdivision.es/images/casco-en-snowdivision-3-128764.jpg</a>]<br/>Localizador: fb10aad2<br/>Fecha: 18/02/2026<br/>N&uacute;mero de d&iacute;as: 3</p><p>TOTAL: 144,00</p><p>Precios con IVA incluido.</p><p>Puedes imprimir el justificante de compra haciendo click en este enlace<br/>[<a href=\"https://rules-shop.es/documentWebExtract?orderGuid=908eb0ea-9f4b-47fd-8e03-3481cfc0a8a3\">https://rules-shop.es/documentWebExtract?orderGuid=908eb0ea-9f4b-47fd-8e03-3481cfc0a8a3</a>].</p><p>Si no puedes usar el enlace puedes pegar la siguiente direcci&oacute;n en tu navegador:<br/><a href=\"https://rules-shop.es/documentWebExtract?orderGuid=908eb0ea-9f4b-47fd-8e03-3481cfc0a8a3\">https://rules-shop.es/documentWebExtract?orderGuid=908eb0ea-9f4b-47fd-8e03-3481cfc0a8a3</a></p><p>INFORMACI&Oacute;N DE INTER&Eacute;S</p><p>Lea atentamente las condiciones generales de reserva adjuntas</p><p>Recuerde llegar con al menos 2 horas de antelaci&oacute;n, de la hora de su clase, a<br/>recoger el material para equiparse, evitar colas y llegar a tiempo, para que<br/>tenga una experiencia inmejorable.</p><p>MATERIAL</p><p>Esta es la direcci&oacute;n para retirar el material:</p><p>[<a href=\"https://sierranevadagranada.com/File/logo-rules-small.png?id=B7EBE528-B54D-4AB9-8CEF-AE5F6B213748\">https://sierranevadagranada.com/File/logo-rules-small.png?id=B7EBE528-B54D-4AB9-8CEF-AE5F6B213748</a>]</p><p>RULES SIERRA NEVADA</p><p>Plaza de Andaluc&iacute;a, Edificio Monachil, locales 1 y 2.</p><p>Frente al parking de autobuses.</p><p>Ver en mapa [<a href=\"https://goo.gl/maps/eUAjCiksJHQUwMPb7\">https://goo.gl/maps/eUAjCiksJHQUwMPb7</a>]</p><p>Presenta este c&oacute;digo QR en la tienda de alquiler para recoger el material m&aacute;s<br/>r&aacute;pidamente:</p><p>[<a href=\"https://snowdivision.es/res/qrImage/SO00043743.gif\">https://snowdivision.es/res/qrImage/SO00043743.gif</a>]</p><p>Puedes venir el d&iacute;a de antes a recoger el material desde 18:30h hasta cierre de<br/>tienda, as&iacute; evitas colas o retrasos.</p><p>HORARIO TIENDA<br/>Todos los d&iacute;as de 8:00h a 20:00h<br/>* Los horarios o servicios pueden modificarse</p><p>INFORMACI&Oacute;N EXCLUSIVA PARA CLIENTES CON CLASES CONTRATADAS</p><p>El punto de encuentro para las CLASES se encuentra en nuestra oficina ubicada en<br/>Borreguiles en la salida del telecabina Al-Andalus a la derecha. SURFIN SIERRA<br/>NEVADA.</p><p>Ante cualquier problema con la hora de llegada o localizaci&oacute;n del punto de<br/>encuentro de pistas (Borreguiles) llame con tiempo al 638 877 288 (tel&eacute;fono de<br/>la Escuela).</p><p>MUY IMPORTANTE &ndash; PARA CLIENTES CON RESERVAS DE CURSILLOS COLECTIVOS</p><p>El curso se realizar&aacute; en grupos de 4 a 10 personas seg&uacute;n el nivel.</p><p>Si no se llega a completar un m&iacute;nimo de 4 personas, el curso se ver&aacute; reducido de<br/>2 horas a 1 hora y de 4 horas a 2 horas, respectivamente. En caso de no llegar a<br/>un m&iacute;nimo de 2 personas, el curso podr&iacute;a verse anulado o modificado, dando la<br/>empresa otras opciones.</p><p>Las clases comenzar&aacute;n a la hora establecida en el bono de confirmaci&oacute;n de<br/>reserva, independientemente del n&uacute;mero de alumnos presentes. Si llegase tarde al<br/>punto de encuentro en Borreguiles por causas ajenas a nuestra empresa, el tiempo<br/>no ser&aacute; recuperable y si este tiempo excede de 20 minutos de la hora de inicio,<br/>no ser&aacute; posible incorporarse al cursillo por motivos del progreso de<br/>aprendizaje.</p><p>FORFAIT para acceder a pistas imprescindible no incluido en los cursillos.</p><p>MUY IMPORTANTE &ndash; PARA CLIENTES CON RESERVAS DE CLASES PARTICULARES</p><p>Las clases comenzar&aacute;n a la hora establecida en el bono de confirmaci&oacute;n de<br/>reserva, independientemente del n&uacute;mero de alumnos presentes. Si llegase tarde al<br/>punto de encuentro en Borreguiles por causas ajenas a nuestra empresa, el tiempo<br/>no ser&aacute; recuperable y si este tiempo excede de 20 minutos de la hora de inicio,<br/>se pierde el derecho a dar la clase.</p><p>FORFAIT para acceder a pistas imprescindible no incluido en los cursillos.</p><p>Por favor, si hay alg&uacute;n error p&oacute;ngase en contacto nuevamente para solucionarlo.<br/>No nos hacemos responsables de errores no notificados.</p><p>Plaza de Pradollano n&uacute;mero 7, 18196, Sierra Nevada, Granada</p><p>Pol&iacute;tica de privacidad [<a href=\"https://snowdivision.es/politica-de-privacidad\">https://snowdivision.es/politica-de-privacidad</a>] |<br/>T&eacute;rminos y condiciones [<a href=\"https://snowdivision.es/terminos-y-condiciones\">https://snowdivision.es/terminos-y-condiciones</a>] |<br/>Pol&iacute;tica de cancelaci&oacute;n [<a href=\"https://snowdivision.es/politica-de-cancelacion\">https://snowdivision.es/politica-de-cancelacion</a>]</p><p>(Mensaje:d59debb5-5296-4741-b8ef-2a256ce1ed37)</p>",
          "subject": "Snow Division - Compra efectuada - Donna-Liza Diependaal - canal Reservas",
          "date": "2026-01-28T08:01:01.000Z",
          "to": {
            "value": [
              {
                "address": "donna.diependaal@gmail.com",
                "name": "Donna-Liza Diependaal"
              }
            ],
            "html": "<span class=\"mp_address_group\"><span class=\"mp_address_name\">Donna-Liza Diependaal</span> &lt;<a href=\"mailto:donna.diependaal@gmail.com\" class=\"mp_address_email\">donna.diependaal@gmail.com</a>&gt;</span>",
            "text": "\"Donna-Liza Diependaal\" <donna.diependaal@gmail.com>"
          },
          "from": {
            "value": [
              {
                "address": "reservas@snowdivision.es",
                "name": ""
              }
            ],
            "html": "<span class=\"mp_address_group\"><a href=\"mailto:reservas@snowdivision.es\" class=\"mp_address_email\">reservas@snowdivision.es</a></span>",
            "text": "reservas@snowdivision.es"
          },
          "messageId": "<6979c23d.170a0220.10dd30.b587@mx.google.com>"
        },
        "pairedItem": {
          "item": 0
        }
      }
    ]
  },
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "shared": [
    {
      "updatedAt": "2026-01-15T07:50:18.781Z",
      "createdAt": "2026-01-15T07:50:18.781Z",
      "role": "workflow:owner",
      "workflowId": "sQUNg-VuSIFLaMIdA9znD",
      "projectId": "x5UZcmGQw2OWHuXb"
    }
  ],
  "staticData": null,
  "tags": [],
  "triggerCount": 3,
  "updatedAt": "2026-01-28T08:43:17.782Z",
  "versionId": "67bdb6dc-6e06-4de8-8630-155b38bd686c"
}